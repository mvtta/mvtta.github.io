<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Mariana Emauz Valdetaro">
<meta name="dcterms.date" content="2025-07-05">

<title>/ - 11 - Comparative Study: CFS-Hypergraph Nautilus/Gravity Simulation vs.&nbsp;CFS+Fibonacci Atom Model</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../../styles.css">
<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">/</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-essays" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Essays</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-essays">    
        <li>
    <a class="dropdown-item" href="../../../posts/essays/index.html">
 <span class="dropdown-text">All Essays</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../posts/essays/relations/index.html">
 <span class="dropdown-text">Relations</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../posts/essays/agency/index.html">
 <span class="dropdown-text">Agency</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../posts/essays/bounderies/index.html">
 <span class="dropdown-text">Boundaries</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../posts/essays/embodiment/index.html">
 <span class="dropdown-text">Embodiment</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../posts/essays/flux/index.html">
 <span class="dropdown-text">Flux</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../posts/essays/intelligence/index.html">
 <span class="dropdown-text">Intelligence</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../posts/essays/selves/index.html">
 <span class="dropdown-text">Selves</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../posts/essays/tech/index.html">
 <span class="dropdown-text">Technology</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../../posts/notebooks/index.html"> 
<span class="menu-text">Notebooks</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../resource-tree.html"> 
<span class="menu-text">Resource-Tree</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../about-me.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#comparative-study-cfs-hypergraph-nautilusgravity-simulation-vs.-cfsfibonacci-atom-model" id="toc-comparative-study-cfs-hypergraph-nautilusgravity-simulation-vs.-cfsfibonacci-atom-model" class="nav-link active" data-scroll-target="#comparative-study-cfs-hypergraph-nautilusgravity-simulation-vs.-cfsfibonacci-atom-model"><span class="header-section-number">1</span> Comparative Study: CFS-Hypergraph Nautilus/Gravity Simulation vs.&nbsp;CFS+Fibonacci Atom Model</a>
  <ul>
  <li><a href="#abstract" id="toc-abstract" class="nav-link" data-scroll-target="#abstract"><span class="header-section-number">1.1</span> Abstract</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction"><span class="header-section-number">1.2</span> 1. Introduction</a></li>
  <li><a href="#methodology" id="toc-methodology" class="nav-link" data-scroll-target="#methodology"><span class="header-section-number">1.3</span> 2. Methodology</a>
  <ul>
  <li><a href="#cfs-hypergraph-nautilusgravity-simulation" id="toc-cfs-hypergraph-nautilusgravity-simulation" class="nav-link" data-scroll-target="#cfs-hypergraph-nautilusgravity-simulation"><span class="header-section-number">1.3.1</span> 2.1 CFS-Hypergraph Nautilus/Gravity Simulation</a></li>
  <li><a href="#cfsfibonacci-atom-model" id="toc-cfsfibonacci-atom-model" class="nav-link" data-scroll-target="#cfsfibonacci-atom-model"><span class="header-section-number">1.3.2</span> 2.2 CFS+Fibonacci Atom Model</a></li>
  </ul></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results"><span class="header-section-number">1.4</span> 3. Results</a>
  <ul>
  <li><a href="#structural-and-causal-organization" id="toc-structural-and-causal-organization" class="nav-link" data-scroll-target="#structural-and-causal-organization"><span class="header-section-number">1.4.1</span> 3.1 Structural and Causal Organization</a></li>
  <li><a href="#visualization-and-physical-interpretation" id="toc-visualization-and-physical-interpretation" class="nav-link" data-scroll-target="#visualization-and-physical-interpretation"><span class="header-section-number">1.4.2</span> 3.2 Visualization and Physical Interpretation</a></li>
  <li><a href="#scientific-and-experimental-validation" id="toc-scientific-and-experimental-validation" class="nav-link" data-scroll-target="#scientific-and-experimental-validation"><span class="header-section-number">1.4.3</span> 3.3 Scientific and Experimental Validation</a></li>
  </ul></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion"><span class="header-section-number">1.5</span> 4. Discussion</a>
  <ul>
  <li><a href="#key-differences" id="toc-key-differences" class="nav-link" data-scroll-target="#key-differences"><span class="header-section-number">1.5.1</span> 4.1 Key Differences</a></li>
  <li><a href="#unified-substrate-distinct-manifestations" id="toc-unified-substrate-distinct-manifestations" class="nav-link" data-scroll-target="#unified-substrate-distinct-manifestations"><span class="header-section-number">1.5.2</span> 4.2 Unified Substrate, Distinct Manifestations</a></li>
  <li><a href="#scientific-insights" id="toc-scientific-insights" class="nav-link" data-scroll-target="#scientific-insights"><span class="header-section-number">1.5.3</span> 4.3 Scientific Insights</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">1.6</span> 5. Conclusion</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">1.7</span> References</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="11-compare-scales.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">11 - Comparative Study: CFS-Hypergraph Nautilus/Gravity Simulation vs.&nbsp;CFS+Fibonacci Atom Model</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Mariana Emauz Valdetaro <a href="mailto:mvaldeta42@gmail.com" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0009-0000-6373-1079" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">05 July 2025</p>
    </div>
  </div>
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="block-title">Abstract</div>
    <p>Agency represents one of the most fundamental yet contested concepts in contemporary scholarship, spanning fields from biology and cognitive science to philosophy and complex systems theory. This article presents a comprehensive definition of agency and agential potential, grounded in an extensive theoretical framework and supported by evidence across multiple scales of organization. We define agency as the spatiotemporally distributed capacity of bounded relational systems to maintain coherent organizational identity while generating novel causal networks through selective boundary-mediated interactions. This reconceptualization moves beyond traditional individualistic frameworks, positioning agency as an emergent property of relational organization that operates through recursive dynamics between autonomy and interdependence.</p>
  </div>
</div>


</header>


<section id="comparative-study-cfs-hypergraph-nautilusgravity-simulation-vs.-cfsfibonacci-atom-model" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Comparative Study: CFS-Hypergraph Nautilus/Gravity Simulation vs.&nbsp;CFS+Fibonacci Atom Model</h1>
<section id="abstract" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="abstract"><span class="header-section-number">1.1</span> Abstract</h2>
<p>This paper presents a comparative analysis of two computational experiments grounded in the Causal Fermion Systems (CFS) framework: (1) a unified CFS-hypergraph simulation modeling the emergence of nautilus-like biological patterns and gravitational effects, and (2) an enhanced CFS+Fibonacci atom model that demonstrates quantum shell structure and transition networks. Both approaches leverage fractal (golden ratio) scaling and causal network principles, but differ in their physical domains, mathematical implementation, and validation strategies. We analyze their methodologies, results, and implications for a universal theory of coherence and structure in nature.</p>
</section>
<section id="introduction" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="introduction"><span class="header-section-number">1.2</span> 1. Introduction</h2>
<p>The Causal Fermion Systems (CFS) framework proposes that the fabric of reality—spanning quantum, biological, and gravitational phenomena—emerges from a measure over a space of operators, with causal and spectral properties dictating physical law. Recent advances have explored how fractal scaling (notably, the golden ratio φ) and information compression principles can be integrated into CFS to explain the emergence of coherent patterns across scales. This study compares two such implementations: one at the macroscopic (biological/gravitational) scale, and one at the quantum (atomic) scale.</p>
</section>
<section id="methodology" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="methodology"><span class="header-section-number">1.3</span> 2. Methodology</h2>
<section id="cfs-hypergraph-nautilusgravity-simulation" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="cfs-hypergraph-nautilusgravity-simulation"><span class="header-section-number">1.3.1</span> 2.1 CFS-Hypergraph Nautilus/Gravity Simulation</h3>
<ul>
<li><strong>Domain:</strong> Macroscopic pattern formation (e.g., nautilus shell) and gravitational effects.</li>
<li><strong>Mathematical Core:</strong> Nodes represent fermion states; hyperedges encode causal relations. Spiral growth follows λ = φⁿ√(DT) scaling, with mass accumulation leading to simulated spacetime curvature.</li>
<li><strong>Validation:</strong> Spiral conformity to the golden ratio, prediction of gravitational compression, and visualization of causal network evolution.</li>
</ul>
</section>
<section id="cfsfibonacci-atom-model" class="level3" data-number="1.3.2">
<h3 data-number="1.3.2" class="anchored" data-anchor-id="cfsfibonacci-atom-model"><span class="header-section-number">1.3.2</span> 2.2 CFS+Fibonacci Atom Model</h3>
<ul>
<li><strong>Domain:</strong> Quantum atomic structure and transitions.</li>
<li><strong>Mathematical Core:</strong> Nodes represent quantum states (orbitals), with positions and coherence determined by λ = φⁿ√(DT). Edges represent allowed quantum transitions (selection rules), and energy levels are derived from CFS spectral properties with fractal scaling.</li>
<li><strong>Validation:</strong> Overlay of analytical hydrogenic orbitals, comparison of radial distributions and energy levels with quantum mechanics, and analysis of transition networks.</li>
</ul>
</section>
</section>
<section id="results" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="results"><span class="header-section-number">1.4</span> 3. Results</h2>
<section id="structural-and-causal-organization" class="level3" data-number="1.4.1">
<h3 data-number="1.4.1" class="anchored" data-anchor-id="structural-and-causal-organization"><span class="header-section-number">1.4.1</span> 3.1 Structural and Causal Organization</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 24%">
<col style="width: 38%">
<col style="width: 37%">
</colgroup>
<thead>
<tr class="header">
<th>Feature</th>
<th>Nautilus/Gravity Simulation</th>
<th>CFS+Fibonacci Atom Model</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Physical Scale</td>
<td>Macroscopic (biological, gravity)</td>
<td>Microscopic (atomic, quantum)</td>
</tr>
<tr class="even">
<td>Main Output</td>
<td>Spiral pattern, curvature</td>
<td>Shell structure, energy levels</td>
</tr>
<tr class="odd">
<td>Causal Network</td>
<td>Growth sequence, mass accumulation</td>
<td>Quantum transitions, selection</td>
</tr>
<tr class="even">
<td>Gravity Modeled</td>
<td>Yes (curvature, compression)</td>
<td>No</td>
</tr>
<tr class="odd">
<td>Analytical Overlay</td>
<td>Golden spiral</td>
<td>Hydrogenic orbitals, QM spectra</td>
</tr>
<tr class="even">
<td>Validation</td>
<td>Spiral conformity, curvature</td>
<td>Shell quantization, energy, transitions</td>
</tr>
</tbody>
</table>
</section>
<section id="visualization-and-physical-interpretation" class="level3" data-number="1.4.2">
<h3 data-number="1.4.2" class="anchored" data-anchor-id="visualization-and-physical-interpretation"><span class="header-section-number">1.4.2</span> 3.2 Visualization and Physical Interpretation</h3>
<ul>
<li><strong>Nautilus/Gravity:</strong> Demonstrates how discrete hypergraph nodes and causal connections generate a nautilus spiral, with accumulated mass-energy producing spacetime curvature and gravitational compression.</li>
<li><strong>Atom Model:</strong> Shows 3D atomic shell structure, quantum transitions, and coherence quantization, with direct overlays of analytical orbitals and energy levels.</li>
</ul>
</section>
<section id="scientific-and-experimental-validation" class="level3" data-number="1.4.3">
<h3 data-number="1.4.3" class="anchored" data-anchor-id="scientific-and-experimental-validation"><span class="header-section-number">1.4.3</span> 3.3 Scientific and Experimental Validation</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 24%">
<col style="width: 33%">
<col style="width: 41%">
</colgroup>
<thead>
<tr class="header">
<th>Validation Aspect</th>
<th>Nautilus/Gravity (Exp. 1)</th>
<th>Atom Model (Exp. 2)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Pattern Conformity</td>
<td>Spiral matches golden ratio</td>
<td>Shells match quantum mechanical radii</td>
</tr>
<tr class="even">
<td>Causal Network</td>
<td>Hyperedges encode growth sequence</td>
<td>Edges encode quantum selection rules</td>
</tr>
<tr class="odd">
<td>Gravity/Curvature</td>
<td>Compression matches mass-energy</td>
<td>Not modeled</td>
</tr>
<tr class="even">
<td>Energy Quantization</td>
<td>Not explicit</td>
<td>Direct comparison with hydrogen atom</td>
</tr>
<tr class="odd">
<td>Transition Animation</td>
<td>Spiral evolution, curvature</td>
<td>Photon emission/absorption, network change</td>
</tr>
<tr class="even">
<td>Conservation Laws</td>
<td>Mass-energy tracked</td>
<td>Coherence and energy tracked</td>
</tr>
<tr class="odd">
<td>Experimental Overlay</td>
<td>Spiral conformity, curvature</td>
<td>Energy levels, radial distributions</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="discussion" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="discussion"><span class="header-section-number">1.5</span> 4. Discussion</h2>
<section id="key-differences" class="level3" data-number="1.5.1">
<h3 data-number="1.5.1" class="anchored" data-anchor-id="key-differences"><span class="header-section-number">1.5.1</span> 4.1 Key Differences</h3>
<ul>
<li><strong>Scale and Phenomenon:</strong> The nautilus/gravity simulation operates at the macroscopic scale, focusing on pattern formation and gravity, while the atom model targets the quantum scale, focusing on atomic quantization and transitions.</li>
<li><strong>Causal Network Role:</strong> In the nautilus/gravity simulation, the causal network encodes growth and mass accumulation, leading to emergent curvature. In the atom model, it encodes quantum transitions and coherence-driven shell formation.</li>
<li><strong>Validation Approach:</strong> The nautilus/gravity simulation validates against geometric conformity and gravitational effects, while the atom model validates against quantum mechanical predictions and experimental data.</li>
</ul>
</section>
<section id="unified-substrate-distinct-manifestations" class="level3" data-number="1.5.2">
<h3 data-number="1.5.2" class="anchored" data-anchor-id="unified-substrate-distinct-manifestations"><span class="header-section-number">1.5.2</span> 4.2 Unified Substrate, Distinct Manifestations</h3>
<p>Both models use CFS as the substrate, but: - <strong>Nautilus/Gravity</strong> demonstrates how CFS can generate classical, macroscopic phenomena (pattern, gravity). - <strong>Atom Model</strong> demonstrates how CFS can generate quantum, microscopic phenomena (atomic structure, transitions).</p>
</section>
<section id="scientific-insights" class="level3" data-number="1.5.3">
<h3 data-number="1.5.3" class="anchored" data-anchor-id="scientific-insights"><span class="header-section-number">1.5.3</span> 4.3 Scientific Insights</h3>
<ul>
<li><strong>Universality of CFS:</strong> Both experiments support the thesis that causal, fractal, and information-compression principles underlie the emergence of structure and coherence across scales.</li>
<li><strong>Fractal and Golden Ratio Scaling:</strong> The φⁿ scaling law provides a unifying thread, introducing self-similarity, directionality, and optimal information compression in both macroscopic and microscopic systems.</li>
<li><strong>Causal Structure as Organizing Principle:</strong> Whether generating a nautilus spiral or atomic shells, the causal network topology is central to the emergence of quantized, coherent patterns.</li>
</ul>
</section>
</section>
<section id="conclusion" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="conclusion"><span class="header-section-number">1.6</span> 5. Conclusion</h2>
<p>This comparative study demonstrates that the CFS framework, when combined with fractal (golden ratio) scaling and information-compression principles, can generate both macroscopic (biological/gravitational) and microscopic (quantum/atomic) structure. The nautilus/gravity simulation shows how CFS hypergraphs can produce both biological patterns and gravitational effects, while the atom model rigorously tests the emergence of quantum structure and transitions. Together, these experiments provide strong evidence that the universe’s organization—across all scales—arises from a universal substrate of causal, fractal, and coherence-enabling networks.</p>
<div id="fada62ba" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mpl_toolkits.mplot3d <span class="im">import</span> Axes3D</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.optimize <span class="im">import</span> minimize</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">'ignore'</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> CFSExperimentalBenchmark:</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.phi <span class="op">=</span> (<span class="dv">1</span> <span class="op">+</span> np.sqrt(<span class="dv">5</span>)) <span class="op">/</span> <span class="dv">2</span>  <span class="co"># Golden ratio</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Comprehensive experimental database</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.experimental_data <span class="op">=</span> <span class="va">self</span>.setup_experimental_database()</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.interaction_cross_sections <span class="op">=</span> <span class="va">self</span>.setup_cross_section_data()</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.decay_channels <span class="op">=</span> <span class="va">self</span>.setup_decay_data()</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Benchmarking thresholds</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.accuracy_thresholds <span class="op">=</span> {</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>            <span class="st">'excellent'</span>: <span class="fl">0.95</span>,</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">'good'</span>: <span class="fl">0.85</span>,</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>            <span class="st">'acceptable'</span>: <span class="fl">0.70</span>,</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>            <span class="st">'poor'</span>: <span class="fl">0.50</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> setup_experimental_database(<span class="va">self</span>):</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Comprehensive experimental particle data"""</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Quarks (masses in MeV)</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>            <span class="st">'up'</span>: {</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>                <span class="st">'mass'</span>: <span class="fl">2.16</span>, <span class="st">'mass_error'</span>: <span class="fl">0.49</span>,</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>                <span class="st">'lifetime'</span>: <span class="bu">float</span>(<span class="st">'inf'</span>), <span class="st">'lifetime_error'</span>: <span class="dv">0</span>,</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>                <span class="st">'charge'</span>: <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>, <span class="st">'spin'</span>: <span class="fl">0.5</span>,</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>                <span class="st">'discovery_year'</span>: <span class="dv">1964</span>,</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>                <span class="st">'pdg_code'</span>: <span class="dv">2</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>            <span class="st">'down'</span>: {</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>                <span class="st">'mass'</span>: <span class="fl">4.67</span>, <span class="st">'mass_error'</span>: <span class="fl">0.48</span>,</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>                <span class="st">'lifetime'</span>: <span class="bu">float</span>(<span class="st">'inf'</span>), <span class="st">'lifetime_error'</span>: <span class="dv">0</span>,</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>                <span class="st">'charge'</span>: <span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">3</span>, <span class="st">'spin'</span>: <span class="fl">0.5</span>,</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>                <span class="st">'discovery_year'</span>: <span class="dv">1964</span>,</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>                <span class="st">'pdg_code'</span>: <span class="dv">1</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>            <span class="st">'charm'</span>: {</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>                <span class="st">'mass'</span>: <span class="dv">1270</span>, <span class="st">'mass_error'</span>: <span class="dv">20</span>,</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>                <span class="st">'lifetime'</span>: <span class="bu">float</span>(<span class="st">'inf'</span>), <span class="st">'lifetime_error'</span>: <span class="dv">0</span>,</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>                <span class="st">'charge'</span>: <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>, <span class="st">'spin'</span>: <span class="fl">0.5</span>,</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>                <span class="st">'discovery_year'</span>: <span class="dv">1974</span>,</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>                <span class="st">'pdg_code'</span>: <span class="dv">4</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>            <span class="st">'strange'</span>: {</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>                <span class="st">'mass'</span>: <span class="fl">93.4</span>, <span class="st">'mass_error'</span>: <span class="fl">5.0</span>,</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>                <span class="st">'lifetime'</span>: <span class="bu">float</span>(<span class="st">'inf'</span>), <span class="st">'lifetime_error'</span>: <span class="dv">0</span>,</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>                <span class="st">'charge'</span>: <span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">3</span>, <span class="st">'spin'</span>: <span class="fl">0.5</span>,</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>                <span class="st">'discovery_year'</span>: <span class="dv">1964</span>,</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>                <span class="st">'pdg_code'</span>: <span class="dv">3</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>            <span class="st">'top'</span>: {</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>                <span class="st">'mass'</span>: <span class="dv">172760</span>, <span class="st">'mass_error'</span>: <span class="dv">300</span>,</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>                <span class="st">'lifetime'</span>: <span class="fl">5e-25</span>, <span class="st">'lifetime_error'</span>: <span class="fl">1e-25</span>,</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>                <span class="st">'charge'</span>: <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>, <span class="st">'spin'</span>: <span class="fl">0.5</span>,</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>                <span class="st">'discovery_year'</span>: <span class="dv">1995</span>,</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>                <span class="st">'pdg_code'</span>: <span class="dv">6</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>            <span class="st">'bottom'</span>: {</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>                <span class="st">'mass'</span>: <span class="dv">4180</span>, <span class="st">'mass_error'</span>: <span class="dv">30</span>,</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>                <span class="st">'lifetime'</span>: <span class="bu">float</span>(<span class="st">'inf'</span>), <span class="st">'lifetime_error'</span>: <span class="dv">0</span>,</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>                <span class="st">'charge'</span>: <span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">3</span>, <span class="st">'spin'</span>: <span class="fl">0.5</span>,</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>                <span class="st">'discovery_year'</span>: <span class="dv">1977</span>,</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>                <span class="st">'pdg_code'</span>: <span class="dv">5</span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Leptons</span></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>            <span class="st">'electron'</span>: {</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>                <span class="st">'mass'</span>: <span class="fl">0.5109989461</span>, <span class="st">'mass_error'</span>: <span class="fl">0.0000000031</span>,</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>                <span class="st">'lifetime'</span>: <span class="bu">float</span>(<span class="st">'inf'</span>), <span class="st">'lifetime_error'</span>: <span class="dv">0</span>,</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>                <span class="st">'charge'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'spin'</span>: <span class="fl">0.5</span>,</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>                <span class="st">'discovery_year'</span>: <span class="dv">1897</span>,</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>                <span class="st">'pdg_code'</span>: <span class="dv">11</span></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>            <span class="st">'muon'</span>: {</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>                <span class="st">'mass'</span>: <span class="fl">105.6583745</span>, <span class="st">'mass_error'</span>: <span class="fl">0.0000024</span>,</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>                <span class="st">'lifetime'</span>: <span class="fl">2.1969811e-6</span>, <span class="st">'lifetime_error'</span>: <span class="fl">0.0000022e-6</span>,</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>                <span class="st">'charge'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'spin'</span>: <span class="fl">0.5</span>,</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>                <span class="st">'discovery_year'</span>: <span class="dv">1936</span>,</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>                <span class="st">'pdg_code'</span>: <span class="dv">13</span></span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>            <span class="st">'tau'</span>: {</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>                <span class="st">'mass'</span>: <span class="fl">1776.86</span>, <span class="st">'mass_error'</span>: <span class="fl">0.12</span>,</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>                <span class="st">'lifetime'</span>: <span class="fl">2.903e-13</span>, <span class="st">'lifetime_error'</span>: <span class="fl">0.005e-13</span>,</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>                <span class="st">'charge'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'spin'</span>: <span class="fl">0.5</span>,</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>                <span class="st">'discovery_year'</span>: <span class="dv">1975</span>,</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>                <span class="st">'pdg_code'</span>: <span class="dv">15</span></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>            <span class="st">'electron_neutrino'</span>: {</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>                <span class="st">'mass'</span>: <span class="fl">0.0</span>, <span class="st">'mass_error'</span>: <span class="fl">1.0</span>,  <span class="co"># Upper limit</span></span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>                <span class="st">'lifetime'</span>: <span class="bu">float</span>(<span class="st">'inf'</span>), <span class="st">'lifetime_error'</span>: <span class="dv">0</span>,</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>                <span class="st">'charge'</span>: <span class="dv">0</span>, <span class="st">'spin'</span>: <span class="fl">0.5</span>,</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>                <span class="st">'discovery_year'</span>: <span class="dv">1956</span>,</span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>                <span class="st">'pdg_code'</span>: <span class="dv">12</span></span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>            <span class="st">'muon_neutrino'</span>: {</span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>                <span class="st">'mass'</span>: <span class="fl">0.0</span>, <span class="st">'mass_error'</span>: <span class="fl">0.19</span>,  <span class="co"># Upper limit</span></span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>                <span class="st">'lifetime'</span>: <span class="bu">float</span>(<span class="st">'inf'</span>), <span class="st">'lifetime_error'</span>: <span class="dv">0</span>,</span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>                <span class="st">'charge'</span>: <span class="dv">0</span>, <span class="st">'spin'</span>: <span class="fl">0.5</span>,</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>                <span class="st">'discovery_year'</span>: <span class="dv">1962</span>,</span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>                <span class="st">'pdg_code'</span>: <span class="dv">14</span></span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>            <span class="st">'tau_neutrino'</span>: {</span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>                <span class="st">'mass'</span>: <span class="fl">0.0</span>, <span class="st">'mass_error'</span>: <span class="fl">18.2</span>,  <span class="co"># Upper limit</span></span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>                <span class="st">'lifetime'</span>: <span class="bu">float</span>(<span class="st">'inf'</span>), <span class="st">'lifetime_error'</span>: <span class="dv">0</span>,</span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>                <span class="st">'charge'</span>: <span class="dv">0</span>, <span class="st">'spin'</span>: <span class="fl">0.5</span>,</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>                <span class="st">'discovery_year'</span>: <span class="dv">2000</span>,</span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>                <span class="st">'pdg_code'</span>: <span class="dv">16</span></span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Gauge bosons</span></span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>            <span class="st">'photon'</span>: {</span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>                <span class="st">'mass'</span>: <span class="fl">0.0</span>, <span class="st">'mass_error'</span>: <span class="fl">1e-18</span>,  <span class="co"># Upper limit</span></span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>                <span class="st">'lifetime'</span>: <span class="bu">float</span>(<span class="st">'inf'</span>), <span class="st">'lifetime_error'</span>: <span class="dv">0</span>,</span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>                <span class="st">'charge'</span>: <span class="dv">0</span>, <span class="st">'spin'</span>: <span class="dv">1</span>,</span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>                <span class="st">'discovery_year'</span>: <span class="dv">1905</span>,</span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>                <span class="st">'pdg_code'</span>: <span class="dv">22</span></span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>            <span class="st">'W_boson'</span>: {</span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>                <span class="st">'mass'</span>: <span class="dv">80379</span>, <span class="st">'mass_error'</span>: <span class="dv">12</span>,</span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>                <span class="st">'lifetime'</span>: <span class="fl">3e-25</span>, <span class="st">'lifetime_error'</span>: <span class="fl">1e-25</span>,</span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>                <span class="st">'charge'</span>: <span class="dv">1</span>, <span class="st">'spin'</span>: <span class="dv">1</span>,</span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a>                <span class="st">'discovery_year'</span>: <span class="dv">1983</span>,</span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a>                <span class="st">'pdg_code'</span>: <span class="dv">24</span></span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Z_boson'</span>: {</span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a>                <span class="st">'mass'</span>: <span class="fl">91187.6</span>, <span class="st">'mass_error'</span>: <span class="fl">2.1</span>,</span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>                <span class="st">'lifetime'</span>: <span class="fl">3e-25</span>, <span class="st">'lifetime_error'</span>: <span class="fl">1e-25</span>,</span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a>                <span class="st">'charge'</span>: <span class="dv">0</span>, <span class="st">'spin'</span>: <span class="dv">1</span>,</span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a>                <span class="st">'discovery_year'</span>: <span class="dv">1983</span>,</span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a>                <span class="st">'pdg_code'</span>: <span class="dv">23</span></span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a>            <span class="st">'gluon'</span>: {</span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a>                <span class="st">'mass'</span>: <span class="fl">0.0</span>, <span class="st">'mass_error'</span>: <span class="fl">0.0</span>,</span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a>                <span class="st">'lifetime'</span>: <span class="bu">float</span>(<span class="st">'inf'</span>), <span class="st">'lifetime_error'</span>: <span class="dv">0</span>,</span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a>                <span class="st">'charge'</span>: <span class="dv">0</span>, <span class="st">'spin'</span>: <span class="dv">1</span>,</span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a>                <span class="st">'discovery_year'</span>: <span class="dv">1979</span>,</span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a>                <span class="st">'pdg_code'</span>: <span class="dv">21</span></span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Higgs</span></span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a>            <span class="st">'higgs'</span>: {</span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a>                <span class="st">'mass'</span>: <span class="dv">125100</span>, <span class="st">'mass_error'</span>: <span class="dv">240</span>,</span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a>                <span class="st">'lifetime'</span>: <span class="fl">1.56e-22</span>, <span class="st">'lifetime_error'</span>: <span class="fl">0.05e-22</span>,</span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a>                <span class="st">'charge'</span>: <span class="dv">0</span>, <span class="st">'spin'</span>: <span class="dv">0</span>,</span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a>                <span class="st">'discovery_year'</span>: <span class="dv">2012</span>,</span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a>                <span class="st">'pdg_code'</span>: <span class="dv">25</span></span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Composite particles</span></span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a>            <span class="st">'proton'</span>: {</span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a>                <span class="st">'mass'</span>: <span class="fl">938.272081</span>, <span class="st">'mass_error'</span>: <span class="fl">0.000006</span>,</span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a>                <span class="st">'lifetime'</span>: <span class="fl">1.67e17</span>, <span class="st">'lifetime_error'</span>: <span class="fl">1e16</span>,  <span class="co"># Years (lower limit)</span></span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a>                <span class="st">'charge'</span>: <span class="dv">1</span>, <span class="st">'spin'</span>: <span class="fl">0.5</span>,</span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a>                <span class="st">'discovery_year'</span>: <span class="dv">1919</span>,</span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a>                <span class="st">'pdg_code'</span>: <span class="dv">2212</span></span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a>            <span class="st">'neutron'</span>: {</span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a>                <span class="st">'mass'</span>: <span class="fl">939.565413</span>, <span class="st">'mass_error'</span>: <span class="fl">0.000006</span>,</span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a>                <span class="st">'lifetime'</span>: <span class="fl">879.4</span>, <span class="st">'lifetime_error'</span>: <span class="fl">0.6</span>,  <span class="co"># Seconds</span></span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a>                <span class="st">'charge'</span>: <span class="dv">0</span>, <span class="st">'spin'</span>: <span class="fl">0.5</span>,</span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a>                <span class="st">'discovery_year'</span>: <span class="dv">1932</span>,</span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a>                <span class="st">'pdg_code'</span>: <span class="dv">2112</span></span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true" tabindex="-1"></a>            <span class="st">'pion_charged'</span>: {</span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true" tabindex="-1"></a>                <span class="st">'mass'</span>: <span class="fl">139.57061</span>, <span class="st">'mass_error'</span>: <span class="fl">0.00024</span>,</span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true" tabindex="-1"></a>                <span class="st">'lifetime'</span>: <span class="fl">2.6033e-8</span>, <span class="st">'lifetime_error'</span>: <span class="fl">0.0005e-8</span>,</span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true" tabindex="-1"></a>                <span class="st">'charge'</span>: <span class="dv">1</span>, <span class="st">'spin'</span>: <span class="dv">0</span>,</span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true" tabindex="-1"></a>                <span class="st">'discovery_year'</span>: <span class="dv">1947</span>,</span>
<span id="cb1-177"><a href="#cb1-177" aria-hidden="true" tabindex="-1"></a>                <span class="st">'pdg_code'</span>: <span class="dv">211</span></span>
<span id="cb1-178"><a href="#cb1-178" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb1-179"><a href="#cb1-179" aria-hidden="true" tabindex="-1"></a>            <span class="st">'pion_neutral'</span>: {</span>
<span id="cb1-180"><a href="#cb1-180" aria-hidden="true" tabindex="-1"></a>                <span class="st">'mass'</span>: <span class="fl">134.9770</span>, <span class="st">'mass_error'</span>: <span class="fl">0.0005</span>,</span>
<span id="cb1-181"><a href="#cb1-181" aria-hidden="true" tabindex="-1"></a>                <span class="st">'lifetime'</span>: <span class="fl">8.52e-17</span>, <span class="st">'lifetime_error'</span>: <span class="fl">0.18e-17</span>,</span>
<span id="cb1-182"><a href="#cb1-182" aria-hidden="true" tabindex="-1"></a>                <span class="st">'charge'</span>: <span class="dv">0</span>, <span class="st">'spin'</span>: <span class="dv">0</span>,</span>
<span id="cb1-183"><a href="#cb1-183" aria-hidden="true" tabindex="-1"></a>                <span class="st">'discovery_year'</span>: <span class="dv">1950</span>,</span>
<span id="cb1-184"><a href="#cb1-184" aria-hidden="true" tabindex="-1"></a>                <span class="st">'pdg_code'</span>: <span class="dv">111</span></span>
<span id="cb1-185"><a href="#cb1-185" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb1-186"><a href="#cb1-186" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb1-187"><a href="#cb1-187" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-188"><a href="#cb1-188" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> setup_cross_section_data(<span class="va">self</span>):</span>
<span id="cb1-189"><a href="#cb1-189" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Experimental cross-section data (in barns)"""</span></span>
<span id="cb1-190"><a href="#cb1-190" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb1-191"><a href="#cb1-191" aria-hidden="true" tabindex="-1"></a>            <span class="st">'electron_muon_scattering'</span>: {</span>
<span id="cb1-192"><a href="#cb1-192" aria-hidden="true" tabindex="-1"></a>                <span class="st">'energy_gev'</span>: [<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">100</span>],</span>
<span id="cb1-193"><a href="#cb1-193" aria-hidden="true" tabindex="-1"></a>                <span class="st">'cross_section_mb'</span>: [<span class="fl">0.089</span>, <span class="fl">0.018</span>, <span class="fl">0.0089</span>, <span class="fl">0.0018</span>, <span class="fl">0.00089</span>],</span>
<span id="cb1-194"><a href="#cb1-194" aria-hidden="true" tabindex="-1"></a>                <span class="st">'error_mb'</span>: [<span class="fl">0.005</span>, <span class="fl">0.001</span>, <span class="fl">0.0005</span>, <span class="fl">0.0001</span>, <span class="fl">0.00005</span>]</span>
<span id="cb1-195"><a href="#cb1-195" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb1-196"><a href="#cb1-196" aria-hidden="true" tabindex="-1"></a>            <span class="st">'proton_proton_elastic'</span>: {</span>
<span id="cb1-197"><a href="#cb1-197" aria-hidden="true" tabindex="-1"></a>                <span class="st">'energy_gev'</span>: [<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">100</span>],</span>
<span id="cb1-198"><a href="#cb1-198" aria-hidden="true" tabindex="-1"></a>                <span class="st">'cross_section_mb'</span>: [<span class="dv">45</span>, <span class="dv">42</span>, <span class="dv">40</span>, <span class="dv">38</span>, <span class="dv">37</span>],</span>
<span id="cb1-199"><a href="#cb1-199" aria-hidden="true" tabindex="-1"></a>                <span class="st">'error_mb'</span>: [<span class="dv">2</span>, <span class="fl">1.5</span>, <span class="fl">1.2</span>, <span class="fl">1.0</span>, <span class="fl">1.0</span>]</span>
<span id="cb1-200"><a href="#cb1-200" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb1-201"><a href="#cb1-201" aria-hidden="true" tabindex="-1"></a>            <span class="st">'neutrino_electron_scattering'</span>: {</span>
<span id="cb1-202"><a href="#cb1-202" aria-hidden="true" tabindex="-1"></a>                <span class="st">'energy_gev'</span>: [<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">100</span>],</span>
<span id="cb1-203"><a href="#cb1-203" aria-hidden="true" tabindex="-1"></a>                <span class="st">'cross_section_cm2'</span>: [<span class="fl">1.7e-41</span>, <span class="fl">8.5e-41</span>, <span class="fl">1.7e-40</span>, <span class="fl">8.5e-40</span>, <span class="fl">1.7e-39</span>],</span>
<span id="cb1-204"><a href="#cb1-204" aria-hidden="true" tabindex="-1"></a>                <span class="st">'error_cm2'</span>: [<span class="fl">0.1e-41</span>, <span class="fl">0.5e-41</span>, <span class="fl">0.1e-40</span>, <span class="fl">0.5e-40</span>, <span class="fl">0.1e-39</span>]</span>
<span id="cb1-205"><a href="#cb1-205" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb1-206"><a href="#cb1-206" aria-hidden="true" tabindex="-1"></a>            <span class="st">'higgs_production'</span>: {</span>
<span id="cb1-207"><a href="#cb1-207" aria-hidden="true" tabindex="-1"></a>                <span class="st">'energy_gev'</span>: [<span class="dv">125</span>, <span class="dv">200</span>, <span class="dv">500</span>, <span class="dv">1000</span>],</span>
<span id="cb1-208"><a href="#cb1-208" aria-hidden="true" tabindex="-1"></a>                <span class="st">'cross_section_pb'</span>: [<span class="fl">48.6</span>, <span class="fl">23.2</span>, <span class="fl">4.9</span>, <span class="fl">1.8</span>],</span>
<span id="cb1-209"><a href="#cb1-209" aria-hidden="true" tabindex="-1"></a>                <span class="st">'error_pb'</span>: [<span class="fl">2.4</span>, <span class="fl">1.2</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>]</span>
<span id="cb1-210"><a href="#cb1-210" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb1-211"><a href="#cb1-211" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb1-212"><a href="#cb1-212" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-213"><a href="#cb1-213" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> setup_decay_data(<span class="va">self</span>):</span>
<span id="cb1-214"><a href="#cb1-214" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Experimental decay channel data"""</span></span>
<span id="cb1-215"><a href="#cb1-215" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb1-216"><a href="#cb1-216" aria-hidden="true" tabindex="-1"></a>            <span class="st">'muon'</span>: {</span>
<span id="cb1-217"><a href="#cb1-217" aria-hidden="true" tabindex="-1"></a>                <span class="st">'decay_channels'</span>: {</span>
<span id="cb1-218"><a href="#cb1-218" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'electron_neutrino_antineutrino'</span>: {<span class="st">'branching_ratio'</span>: <span class="fl">1.0</span>, <span class="st">'error'</span>: <span class="fl">0.0</span>}</span>
<span id="cb1-219"><a href="#cb1-219" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb1-220"><a href="#cb1-220" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb1-221"><a href="#cb1-221" aria-hidden="true" tabindex="-1"></a>            <span class="st">'tau'</span>: {</span>
<span id="cb1-222"><a href="#cb1-222" aria-hidden="true" tabindex="-1"></a>                <span class="st">'decay_channels'</span>: {</span>
<span id="cb1-223"><a href="#cb1-223" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'electron_neutrino_antineutrino'</span>: {<span class="st">'branching_ratio'</span>: <span class="fl">0.1782</span>, <span class="st">'error'</span>: <span class="fl">0.0004</span>},</span>
<span id="cb1-224"><a href="#cb1-224" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'muon_neutrino_antineutrino'</span>: {<span class="st">'branching_ratio'</span>: <span class="fl">0.1739</span>, <span class="st">'error'</span>: <span class="fl">0.0004</span>},</span>
<span id="cb1-225"><a href="#cb1-225" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'hadron_neutrino'</span>: {<span class="st">'branching_ratio'</span>: <span class="fl">0.6479</span>, <span class="st">'error'</span>: <span class="fl">0.0008</span>}</span>
<span id="cb1-226"><a href="#cb1-226" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb1-227"><a href="#cb1-227" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb1-228"><a href="#cb1-228" aria-hidden="true" tabindex="-1"></a>            <span class="st">'W_boson'</span>: {</span>
<span id="cb1-229"><a href="#cb1-229" aria-hidden="true" tabindex="-1"></a>                <span class="st">'decay_channels'</span>: {</span>
<span id="cb1-230"><a href="#cb1-230" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'lepton_neutrino'</span>: {<span class="st">'branching_ratio'</span>: <span class="fl">0.326</span>, <span class="st">'error'</span>: <span class="fl">0.008</span>},</span>
<span id="cb1-231"><a href="#cb1-231" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'quark_antiquark'</span>: {<span class="st">'branching_ratio'</span>: <span class="fl">0.674</span>, <span class="st">'error'</span>: <span class="fl">0.008</span>}</span>
<span id="cb1-232"><a href="#cb1-232" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb1-233"><a href="#cb1-233" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb1-234"><a href="#cb1-234" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Z_boson'</span>: {</span>
<span id="cb1-235"><a href="#cb1-235" aria-hidden="true" tabindex="-1"></a>                <span class="st">'decay_channels'</span>: {</span>
<span id="cb1-236"><a href="#cb1-236" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'neutrino_antineutrino'</span>: {<span class="st">'branching_ratio'</span>: <span class="fl">0.200</span>, <span class="st">'error'</span>: <span class="fl">0.001</span>},</span>
<span id="cb1-237"><a href="#cb1-237" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'charged_lepton_pair'</span>: {<span class="st">'branching_ratio'</span>: <span class="fl">0.067</span>, <span class="st">'error'</span>: <span class="fl">0.001</span>},</span>
<span id="cb1-238"><a href="#cb1-238" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'quark_antiquark'</span>: {<span class="st">'branching_ratio'</span>: <span class="fl">0.696</span>, <span class="st">'error'</span>: <span class="fl">0.002</span>}</span>
<span id="cb1-239"><a href="#cb1-239" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb1-240"><a href="#cb1-240" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb1-241"><a href="#cb1-241" aria-hidden="true" tabindex="-1"></a>            <span class="st">'higgs'</span>: {</span>
<span id="cb1-242"><a href="#cb1-242" aria-hidden="true" tabindex="-1"></a>                <span class="st">'decay_channels'</span>: {</span>
<span id="cb1-243"><a href="#cb1-243" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'bottom_antibottom'</span>: {<span class="st">'branching_ratio'</span>: <span class="fl">0.582</span>, <span class="st">'error'</span>: <span class="fl">0.006</span>},</span>
<span id="cb1-244"><a href="#cb1-244" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'W_W'</span>: {<span class="st">'branching_ratio'</span>: <span class="fl">0.215</span>, <span class="st">'error'</span>: <span class="fl">0.009</span>},</span>
<span id="cb1-245"><a href="#cb1-245" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'gluon_gluon'</span>: {<span class="st">'branching_ratio'</span>: <span class="fl">0.082</span>, <span class="st">'error'</span>: <span class="fl">0.005</span>},</span>
<span id="cb1-246"><a href="#cb1-246" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'tau_antitau'</span>: {<span class="st">'branching_ratio'</span>: <span class="fl">0.063</span>, <span class="st">'error'</span>: <span class="fl">0.003</span>},</span>
<span id="cb1-247"><a href="#cb1-247" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Z_Z'</span>: {<span class="st">'branching_ratio'</span>: <span class="fl">0.026</span>, <span class="st">'error'</span>: <span class="fl">0.001</span>},</span>
<span id="cb1-248"><a href="#cb1-248" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'photon_photon'</span>: {<span class="st">'branching_ratio'</span>: <span class="fl">0.002</span>, <span class="st">'error'</span>: <span class="fl">0.0001</span>}</span>
<span id="cb1-249"><a href="#cb1-249" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb1-250"><a href="#cb1-250" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb1-251"><a href="#cb1-251" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb1-252"><a href="#cb1-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-253"><a href="#cb1-253" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> CFSBenchmarkingEngine(CFSExperimentalBenchmark):</span>
<span id="cb1-254"><a href="#cb1-254" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, cfs_simulator):</span>
<span id="cb1-255"><a href="#cb1-255" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb1-256"><a href="#cb1-256" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.cfs_sim <span class="op">=</span> cfs_simulator</span>
<span id="cb1-257"><a href="#cb1-257" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.benchmark_results <span class="op">=</span> {}</span>
<span id="cb1-258"><a href="#cb1-258" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-259"><a href="#cb1-259" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> calculate_mass_accuracy(<span class="va">self</span>):</span>
<span id="cb1-260"><a href="#cb1-260" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Calculate mass prediction accuracy"""</span></span>
<span id="cb1-261"><a href="#cb1-261" aria-hidden="true" tabindex="-1"></a>        mass_comparisons <span class="op">=</span> {}</span>
<span id="cb1-262"><a href="#cb1-262" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-263"><a href="#cb1-263" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> particle_name <span class="kw">in</span> <span class="va">self</span>.experimental_data.keys():</span>
<span id="cb1-264"><a href="#cb1-264" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> particle_name <span class="kw">in</span> <span class="va">self</span>.cfs_sim.particles:</span>
<span id="cb1-265"><a href="#cb1-265" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Get CFS predicted mass</span></span>
<span id="cb1-266"><a href="#cb1-266" aria-hidden="true" tabindex="-1"></a>                cfs_coherence <span class="op">=</span> <span class="va">self</span>.cfs_sim.cfs_particle_coherence(particle_name)</span>
<span id="cb1-267"><a href="#cb1-267" aria-hidden="true" tabindex="-1"></a>                cfs_mass <span class="op">=</span> <span class="va">self</span>.coherence_to_mass(cfs_coherence, particle_name)</span>
<span id="cb1-268"><a href="#cb1-268" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb1-269"><a href="#cb1-269" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Get experimental mass</span></span>
<span id="cb1-270"><a href="#cb1-270" aria-hidden="true" tabindex="-1"></a>                exp_mass <span class="op">=</span> <span class="va">self</span>.experimental_data[particle_name][<span class="st">'mass'</span>]</span>
<span id="cb1-271"><a href="#cb1-271" aria-hidden="true" tabindex="-1"></a>                exp_error <span class="op">=</span> <span class="va">self</span>.experimental_data[particle_name][<span class="st">'mass_error'</span>]</span>
<span id="cb1-272"><a href="#cb1-272" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb1-273"><a href="#cb1-273" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Calculate accuracy metrics</span></span>
<span id="cb1-274"><a href="#cb1-274" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> exp_mass <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb1-275"><a href="#cb1-275" aria-hidden="true" tabindex="-1"></a>                    relative_error <span class="op">=</span> <span class="bu">abs</span>(cfs_mass <span class="op">-</span> exp_mass) <span class="op">/</span> exp_mass</span>
<span id="cb1-276"><a href="#cb1-276" aria-hidden="true" tabindex="-1"></a>                    accuracy <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> relative_error</span>
<span id="cb1-277"><a href="#cb1-277" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb1-278"><a href="#cb1-278" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Statistical significance</span></span>
<span id="cb1-279"><a href="#cb1-279" aria-hidden="true" tabindex="-1"></a>                    z_score <span class="op">=</span> <span class="bu">abs</span>(cfs_mass <span class="op">-</span> exp_mass) <span class="op">/</span> exp_error <span class="cf">if</span> exp_error <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="bu">float</span>(<span class="st">'inf'</span>)</span>
<span id="cb1-280"><a href="#cb1-280" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb1-281"><a href="#cb1-281" aria-hidden="true" tabindex="-1"></a>                    mass_comparisons[particle_name] <span class="op">=</span> {</span>
<span id="cb1-282"><a href="#cb1-282" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'cfs_mass'</span>: cfs_mass,</span>
<span id="cb1-283"><a href="#cb1-283" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'exp_mass'</span>: exp_mass,</span>
<span id="cb1-284"><a href="#cb1-284" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'exp_error'</span>: exp_error,</span>
<span id="cb1-285"><a href="#cb1-285" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'relative_error'</span>: relative_error,</span>
<span id="cb1-286"><a href="#cb1-286" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'accuracy'</span>: accuracy,</span>
<span id="cb1-287"><a href="#cb1-287" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'z_score'</span>: z_score,</span>
<span id="cb1-288"><a href="#cb1-288" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'agreement_level'</span>: <span class="va">self</span>.classify_agreement(accuracy)</span>
<span id="cb1-289"><a href="#cb1-289" aria-hidden="true" tabindex="-1"></a>                    }</span>
<span id="cb1-290"><a href="#cb1-290" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-291"><a href="#cb1-291" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> mass_comparisons</span>
<span id="cb1-292"><a href="#cb1-292" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-293"><a href="#cb1-293" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> coherence_to_mass(<span class="va">self</span>, coherence, particle_name):</span>
<span id="cb1-294"><a href="#cb1-294" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Convert CFS coherence to mass using scaling relationship"""</span></span>
<span id="cb1-295"><a href="#cb1-295" aria-hidden="true" tabindex="-1"></a>        particle <span class="op">=</span> <span class="va">self</span>.cfs_sim.particles[particle_name]</span>
<span id="cb1-296"><a href="#cb1-296" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-297"><a href="#cb1-297" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Mass-energy relationship with CFS scaling</span></span>
<span id="cb1-298"><a href="#cb1-298" aria-hidden="true" tabindex="-1"></a>        <span class="co"># E = mc² = λ²α where α is interaction-dependent</span></span>
<span id="cb1-299"><a href="#cb1-299" aria-hidden="true" tabindex="-1"></a>        alpha_factor <span class="op">=</span> {</span>
<span id="cb1-300"><a href="#cb1-300" aria-hidden="true" tabindex="-1"></a>            <span class="st">'quark'</span>: <span class="va">self</span>.cfs_sim.alpha_s,</span>
<span id="cb1-301"><a href="#cb1-301" aria-hidden="true" tabindex="-1"></a>            <span class="st">'lepton'</span>: <span class="va">self</span>.cfs_sim.alpha_em,</span>
<span id="cb1-302"><a href="#cb1-302" aria-hidden="true" tabindex="-1"></a>            <span class="st">'gauge'</span>: <span class="va">self</span>.cfs_sim.alpha_w,</span>
<span id="cb1-303"><a href="#cb1-303" aria-hidden="true" tabindex="-1"></a>            <span class="st">'scalar'</span>: <span class="va">self</span>.cfs_sim.alpha_em</span>
<span id="cb1-304"><a href="#cb1-304" aria-hidden="true" tabindex="-1"></a>        }.get(particle[<span class="st">'type'</span>], <span class="fl">1.0</span>)</span>
<span id="cb1-305"><a href="#cb1-305" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-306"><a href="#cb1-306" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Convert coherence to mass (MeV)</span></span>
<span id="cb1-307"><a href="#cb1-307" aria-hidden="true" tabindex="-1"></a>        mass_scale <span class="op">=</span> <span class="dv">1000</span> <span class="op">*</span> alpha_factor  <span class="co"># Scaling factor</span></span>
<span id="cb1-308"><a href="#cb1-308" aria-hidden="true" tabindex="-1"></a>        predicted_mass <span class="op">=</span> (coherence <span class="op">**</span> <span class="dv">2</span>) <span class="op">*</span> mass_scale</span>
<span id="cb1-309"><a href="#cb1-309" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-310"><a href="#cb1-310" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> predicted_mass</span>
<span id="cb1-311"><a href="#cb1-311" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-312"><a href="#cb1-312" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> calculate_lifetime_accuracy(<span class="va">self</span>):</span>
<span id="cb1-313"><a href="#cb1-313" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Calculate lifetime prediction accuracy"""</span></span>
<span id="cb1-314"><a href="#cb1-314" aria-hidden="true" tabindex="-1"></a>        lifetime_comparisons <span class="op">=</span> {}</span>
<span id="cb1-315"><a href="#cb1-315" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-316"><a href="#cb1-316" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> particle_name <span class="kw">in</span> <span class="va">self</span>.experimental_data.keys():</span>
<span id="cb1-317"><a href="#cb1-317" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> particle_name <span class="kw">in</span> <span class="va">self</span>.cfs_sim.particles:</span>
<span id="cb1-318"><a href="#cb1-318" aria-hidden="true" tabindex="-1"></a>                exp_lifetime <span class="op">=</span> <span class="va">self</span>.experimental_data[particle_name][<span class="st">'lifetime'</span>]</span>
<span id="cb1-319"><a href="#cb1-319" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb1-320"><a href="#cb1-320" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> np.isfinite(exp_lifetime):  <span class="co"># Skip stable particles</span></span>
<span id="cb1-321"><a href="#cb1-321" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># CFS lifetime prediction from coherence decay</span></span>
<span id="cb1-322"><a href="#cb1-322" aria-hidden="true" tabindex="-1"></a>                    coherence <span class="op">=</span> <span class="va">self</span>.cfs_sim.cfs_particle_coherence(particle_name)</span>
<span id="cb1-323"><a href="#cb1-323" aria-hidden="true" tabindex="-1"></a>                    cfs_lifetime <span class="op">=</span> <span class="va">self</span>.coherence_to_lifetime(coherence, particle_name)</span>
<span id="cb1-324"><a href="#cb1-324" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb1-325"><a href="#cb1-325" aria-hidden="true" tabindex="-1"></a>                    exp_error <span class="op">=</span> <span class="va">self</span>.experimental_data[particle_name][<span class="st">'lifetime_error'</span>]</span>
<span id="cb1-326"><a href="#cb1-326" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb1-327"><a href="#cb1-327" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Log-scale comparison for lifetimes spanning many orders</span></span>
<span id="cb1-328"><a href="#cb1-328" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> cfs_lifetime <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">and</span> exp_lifetime <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb1-329"><a href="#cb1-329" aria-hidden="true" tabindex="-1"></a>                        log_error <span class="op">=</span> <span class="bu">abs</span>(np.log10(cfs_lifetime) <span class="op">-</span> np.log10(exp_lifetime))</span>
<span id="cb1-330"><a href="#cb1-330" aria-hidden="true" tabindex="-1"></a>                        accuracy <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> log_error)</span>
<span id="cb1-331"><a href="#cb1-331" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb1-332"><a href="#cb1-332" aria-hidden="true" tabindex="-1"></a>                        lifetime_comparisons[particle_name] <span class="op">=</span> {</span>
<span id="cb1-333"><a href="#cb1-333" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'cfs_lifetime'</span>: cfs_lifetime,</span>
<span id="cb1-334"><a href="#cb1-334" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'exp_lifetime'</span>: exp_lifetime,</span>
<span id="cb1-335"><a href="#cb1-335" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'exp_error'</span>: exp_error,</span>
<span id="cb1-336"><a href="#cb1-336" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'log_error'</span>: log_error,</span>
<span id="cb1-337"><a href="#cb1-337" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'accuracy'</span>: accuracy,</span>
<span id="cb1-338"><a href="#cb1-338" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'agreement_level'</span>: <span class="va">self</span>.classify_agreement(accuracy)</span>
<span id="cb1-339"><a href="#cb1-339" aria-hidden="true" tabindex="-1"></a>                        }</span>
<span id="cb1-340"><a href="#cb1-340" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-341"><a href="#cb1-341" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> lifetime_comparisons</span>
<span id="cb1-342"><a href="#cb1-342" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-343"><a href="#cb1-343" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> coherence_to_lifetime(<span class="va">self</span>, coherence, particle_name):</span>
<span id="cb1-344"><a href="#cb1-344" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Convert CFS coherence to particle lifetime"""</span></span>
<span id="cb1-345"><a href="#cb1-345" aria-hidden="true" tabindex="-1"></a>        particle <span class="op">=</span> <span class="va">self</span>.cfs_sim.particles[particle_name]</span>
<span id="cb1-346"><a href="#cb1-346" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-347"><a href="#cb1-347" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Lifetime from coherence decay rate</span></span>
<span id="cb1-348"><a href="#cb1-348" aria-hidden="true" tabindex="-1"></a>        <span class="co"># τ = ħ/Γ where Γ ∝ 1/coherence²</span></span>
<span id="cb1-349"><a href="#cb1-349" aria-hidden="true" tabindex="-1"></a>        hbar <span class="op">=</span> <span class="fl">6.582119569e-25</span>  <span class="co"># GeV⋅s</span></span>
<span id="cb1-350"><a href="#cb1-350" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-351"><a href="#cb1-351" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Decay width from inverse coherence</span></span>
<span id="cb1-352"><a href="#cb1-352" aria-hidden="true" tabindex="-1"></a>        gamma <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (coherence <span class="op">**</span> <span class="dv">2</span>) <span class="cf">if</span> coherence <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="bu">float</span>(<span class="st">'inf'</span>)</span>
<span id="cb1-353"><a href="#cb1-353" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-354"><a href="#cb1-354" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Scale by particle type</span></span>
<span id="cb1-355"><a href="#cb1-355" aria-hidden="true" tabindex="-1"></a>        type_factors <span class="op">=</span> {</span>
<span id="cb1-356"><a href="#cb1-356" aria-hidden="true" tabindex="-1"></a>            <span class="st">'quark'</span>: <span class="fl">1e-24</span>,</span>
<span id="cb1-357"><a href="#cb1-357" aria-hidden="true" tabindex="-1"></a>            <span class="st">'lepton'</span>: <span class="fl">1e-6</span>,</span>
<span id="cb1-358"><a href="#cb1-358" aria-hidden="true" tabindex="-1"></a>            <span class="st">'gauge'</span>: <span class="fl">1e-25</span>,</span>
<span id="cb1-359"><a href="#cb1-359" aria-hidden="true" tabindex="-1"></a>            <span class="st">'scalar'</span>: <span class="fl">1e-22</span></span>
<span id="cb1-360"><a href="#cb1-360" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb1-361"><a href="#cb1-361" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-362"><a href="#cb1-362" aria-hidden="true" tabindex="-1"></a>        scale_factor <span class="op">=</span> type_factors.get(particle[<span class="st">'type'</span>], <span class="fl">1e-15</span>)</span>
<span id="cb1-363"><a href="#cb1-363" aria-hidden="true" tabindex="-1"></a>        lifetime <span class="op">=</span> hbar <span class="op">*</span> scale_factor <span class="op">/</span> gamma <span class="cf">if</span> gamma <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="bu">float</span>(<span class="st">'inf'</span>)</span>
<span id="cb1-364"><a href="#cb1-364" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-365"><a href="#cb1-365" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> lifetime</span>
<span id="cb1-366"><a href="#cb1-366" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-367"><a href="#cb1-367" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> calculate_cross_section_accuracy(<span class="va">self</span>):</span>
<span id="cb1-368"><a href="#cb1-368" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Calculate interaction cross-section accuracy"""</span></span>
<span id="cb1-369"><a href="#cb1-369" aria-hidden="true" tabindex="-1"></a>        cross_section_comparisons <span class="op">=</span> {}</span>
<span id="cb1-370"><a href="#cb1-370" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-371"><a href="#cb1-371" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> process_name, process_data <span class="kw">in</span> <span class="va">self</span>.interaction_cross_sections.items():</span>
<span id="cb1-372"><a href="#cb1-372" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Calculate CFS cross-sections for this process</span></span>
<span id="cb1-373"><a href="#cb1-373" aria-hidden="true" tabindex="-1"></a>            cfs_cross_sections <span class="op">=</span> <span class="va">self</span>.cfs_cross_section_prediction(process_name, process_data)</span>
<span id="cb1-374"><a href="#cb1-374" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-375"><a href="#cb1-375" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> cfs_cross_sections <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb1-376"><a href="#cb1-376" aria-hidden="true" tabindex="-1"></a>                exp_cross_sections <span class="op">=</span> process_data[<span class="st">'cross_section_mb'</span>]</span>
<span id="cb1-377"><a href="#cb1-377" aria-hidden="true" tabindex="-1"></a>                energies <span class="op">=</span> process_data[<span class="st">'energy_gev'</span>]</span>
<span id="cb1-378"><a href="#cb1-378" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb1-379"><a href="#cb1-379" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Calculate accuracy for each energy point</span></span>
<span id="cb1-380"><a href="#cb1-380" aria-hidden="true" tabindex="-1"></a>                accuracies <span class="op">=</span> []</span>
<span id="cb1-381"><a href="#cb1-381" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> i, (cfs_cs, exp_cs) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">zip</span>(cfs_cross_sections, exp_cross_sections)):</span>
<span id="cb1-382"><a href="#cb1-382" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> exp_cs <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb1-383"><a href="#cb1-383" aria-hidden="true" tabindex="-1"></a>                        relative_error <span class="op">=</span> <span class="bu">abs</span>(cfs_cs <span class="op">-</span> exp_cs) <span class="op">/</span> exp_cs</span>
<span id="cb1-384"><a href="#cb1-384" aria-hidden="true" tabindex="-1"></a>                        accuracy <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> relative_error</span>
<span id="cb1-385"><a href="#cb1-385" aria-hidden="true" tabindex="-1"></a>                        accuracies.append(accuracy)</span>
<span id="cb1-386"><a href="#cb1-386" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb1-387"><a href="#cb1-387" aria-hidden="true" tabindex="-1"></a>                avg_accuracy <span class="op">=</span> np.mean(accuracies) <span class="cf">if</span> accuracies <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb1-388"><a href="#cb1-388" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb1-389"><a href="#cb1-389" aria-hidden="true" tabindex="-1"></a>                cross_section_comparisons[process_name] <span class="op">=</span> {</span>
<span id="cb1-390"><a href="#cb1-390" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'energies'</span>: energies,</span>
<span id="cb1-391"><a href="#cb1-391" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'cfs_cross_sections'</span>: cfs_cross_sections,</span>
<span id="cb1-392"><a href="#cb1-392" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'exp_cross_sections'</span>: exp_cross_sections,</span>
<span id="cb1-393"><a href="#cb1-393" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'accuracies'</span>: accuracies,</span>
<span id="cb1-394"><a href="#cb1-394" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'avg_accuracy'</span>: avg_accuracy,</span>
<span id="cb1-395"><a href="#cb1-395" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'agreement_level'</span>: <span class="va">self</span>.classify_agreement(avg_accuracy)</span>
<span id="cb1-396"><a href="#cb1-396" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb1-397"><a href="#cb1-397" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-398"><a href="#cb1-398" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> cross_section_comparisons</span>
<span id="cb1-399"><a href="#cb1-399" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-400"><a href="#cb1-400" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> cfs_cross_section_prediction(<span class="va">self</span>, process_name, process_data):</span>
<span id="cb1-401"><a href="#cb1-401" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Predict cross-sections using CFS signature matching"""</span></span>
<span id="cb1-402"><a href="#cb1-402" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">'electron_muon'</span> <span class="kw">in</span> process_name:</span>
<span id="cb1-403"><a href="#cb1-403" aria-hidden="true" tabindex="-1"></a>            <span class="co"># e-μ scattering via photon exchange</span></span>
<span id="cb1-404"><a href="#cb1-404" aria-hidden="true" tabindex="-1"></a>            energies <span class="op">=</span> process_data[<span class="st">'energy_gev'</span>]</span>
<span id="cb1-405"><a href="#cb1-405" aria-hidden="true" tabindex="-1"></a>            cross_sections <span class="op">=</span> []</span>
<span id="cb1-406"><a href="#cb1-406" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-407"><a href="#cb1-407" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> energy <span class="kw">in</span> energies:</span>
<span id="cb1-408"><a href="#cb1-408" aria-hidden="true" tabindex="-1"></a>                <span class="co"># CFS prediction: σ ∝ (signature_match × α_em²) / s</span></span>
<span id="cb1-409"><a href="#cb1-409" aria-hidden="true" tabindex="-1"></a>                e_coherence <span class="op">=</span> <span class="va">self</span>.cfs_sim.cfs_particle_coherence(<span class="st">'electron'</span>)</span>
<span id="cb1-410"><a href="#cb1-410" aria-hidden="true" tabindex="-1"></a>                mu_coherence <span class="op">=</span> <span class="va">self</span>.cfs_sim.cfs_particle_coherence(<span class="st">'muon'</span>)</span>
<span id="cb1-411"><a href="#cb1-411" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb1-412"><a href="#cb1-412" aria-hidden="true" tabindex="-1"></a>                signature_match <span class="op">=</span> <span class="va">self</span>.cfs_sim.signature_matching(<span class="st">'electron'</span>, <span class="st">'muon'</span>)</span>
<span id="cb1-413"><a href="#cb1-413" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb1-414"><a href="#cb1-414" aria-hidden="true" tabindex="-1"></a>                <span class="co"># QED scaling with CFS enhancement</span></span>
<span id="cb1-415"><a href="#cb1-415" aria-hidden="true" tabindex="-1"></a>                alpha_em_sq <span class="op">=</span> <span class="va">self</span>.cfs_sim.alpha_em <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb1-416"><a href="#cb1-416" aria-hidden="true" tabindex="-1"></a>                s <span class="op">=</span> energy <span class="op">**</span> <span class="dv">2</span>  <span class="co"># Center of mass energy squared</span></span>
<span id="cb1-417"><a href="#cb1-417" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb1-418"><a href="#cb1-418" aria-hidden="true" tabindex="-1"></a>                cross_section <span class="op">=</span> (signature_match <span class="op">*</span> alpha_em_sq <span class="op">*</span> <span class="dv">1000</span>) <span class="op">/</span> s  <span class="co"># mb</span></span>
<span id="cb1-419"><a href="#cb1-419" aria-hidden="true" tabindex="-1"></a>                cross_sections.append(cross_section)</span>
<span id="cb1-420"><a href="#cb1-420" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-421"><a href="#cb1-421" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> cross_sections</span>
<span id="cb1-422"><a href="#cb1-422" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-423"><a href="#cb1-423" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">'proton_proton'</span> <span class="kw">in</span> process_name:</span>
<span id="cb1-424"><a href="#cb1-424" aria-hidden="true" tabindex="-1"></a>            <span class="co"># p-p elastic scattering</span></span>
<span id="cb1-425"><a href="#cb1-425" aria-hidden="true" tabindex="-1"></a>            energies <span class="op">=</span> process_data[<span class="st">'energy_gev'</span>]</span>
<span id="cb1-426"><a href="#cb1-426" aria-hidden="true" tabindex="-1"></a>            cross_sections <span class="op">=</span> []</span>
<span id="cb1-427"><a href="#cb1-427" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-428"><a href="#cb1-428" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> energy <span class="kw">in</span> energies:</span>
<span id="cb1-429"><a href="#cb1-429" aria-hidden="true" tabindex="-1"></a>                <span class="co"># CFS prediction with strong force signatures</span></span>
<span id="cb1-430"><a href="#cb1-430" aria-hidden="true" tabindex="-1"></a>                p_coherence <span class="op">=</span> <span class="va">self</span>.cfs_sim.cfs_particle_coherence(<span class="st">'proton'</span>) <span class="cf">if</span> <span class="bu">hasattr</span>(<span class="va">self</span>.cfs_sim, <span class="st">'generate_composite_particles'</span>) <span class="cf">else</span> <span class="fl">1.0</span></span>
<span id="cb1-431"><a href="#cb1-431" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb1-432"><a href="#cb1-432" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Strong interaction scaling</span></span>
<span id="cb1-433"><a href="#cb1-433" aria-hidden="true" tabindex="-1"></a>                alpha_s <span class="op">=</span> <span class="va">self</span>.cfs_sim.alpha_s</span>
<span id="cb1-434"><a href="#cb1-434" aria-hidden="true" tabindex="-1"></a>                cross_section <span class="op">=</span> <span class="dv">40</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> alpha_s) <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> energy<span class="op">/</span><span class="dv">10</span>)  <span class="co"># Phenomenological</span></span>
<span id="cb1-435"><a href="#cb1-435" aria-hidden="true" tabindex="-1"></a>                cross_sections.append(cross_section)</span>
<span id="cb1-436"><a href="#cb1-436" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-437"><a href="#cb1-437" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> cross_sections</span>
<span id="cb1-438"><a href="#cb1-438" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-439"><a href="#cb1-439" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb1-440"><a href="#cb1-440" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-441"><a href="#cb1-441" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> classify_agreement(<span class="va">self</span>, accuracy):</span>
<span id="cb1-442"><a href="#cb1-442" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Classify agreement level based on accuracy"""</span></span>
<span id="cb1-443"><a href="#cb1-443" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> accuracy <span class="op">&gt;=</span> <span class="va">self</span>.accuracy_thresholds[<span class="st">'excellent'</span>]:</span>
<span id="cb1-444"><a href="#cb1-444" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">'excellent'</span></span>
<span id="cb1-445"><a href="#cb1-445" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> accuracy <span class="op">&gt;=</span> <span class="va">self</span>.accuracy_thresholds[<span class="st">'good'</span>]:</span>
<span id="cb1-446"><a href="#cb1-446" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">'good'</span></span>
<span id="cb1-447"><a href="#cb1-447" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> accuracy <span class="op">&gt;=</span> <span class="va">self</span>.accuracy_thresholds[<span class="st">'acceptable'</span>]:</span>
<span id="cb1-448"><a href="#cb1-448" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">'acceptable'</span></span>
<span id="cb1-449"><a href="#cb1-449" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> accuracy <span class="op">&gt;=</span> <span class="va">self</span>.accuracy_thresholds[<span class="st">'poor'</span>]:</span>
<span id="cb1-450"><a href="#cb1-450" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">'poor'</span></span>
<span id="cb1-451"><a href="#cb1-451" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb1-452"><a href="#cb1-452" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">'very_poor'</span></span>
<span id="cb1-453"><a href="#cb1-453" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-454"><a href="#cb1-454" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> run_comprehensive_benchmark(<span class="va">self</span>):</span>
<span id="cb1-455"><a href="#cb1-455" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Run complete benchmarking analysis"""</span></span>
<span id="cb1-456"><a href="#cb1-456" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"=== CFS Standard Model Benchmarking ==="</span>)</span>
<span id="cb1-457"><a href="#cb1-457" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"Comparing simulation with experimental data..."</span>)</span>
<span id="cb1-458"><a href="#cb1-458" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-459"><a href="#cb1-459" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculate all accuracy metrics</span></span>
<span id="cb1-460"><a href="#cb1-460" aria-hidden="true" tabindex="-1"></a>        mass_results <span class="op">=</span> <span class="va">self</span>.calculate_mass_accuracy()</span>
<span id="cb1-461"><a href="#cb1-461" aria-hidden="true" tabindex="-1"></a>        lifetime_results <span class="op">=</span> <span class="va">self</span>.calculate_lifetime_accuracy()</span>
<span id="cb1-462"><a href="#cb1-462" aria-hidden="true" tabindex="-1"></a>        cross_section_results <span class="op">=</span> <span class="va">self</span>.calculate_cross_section_accuracy()</span>
<span id="cb1-463"><a href="#cb1-463" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-464"><a href="#cb1-464" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Store results</span></span>
<span id="cb1-465"><a href="#cb1-465" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.benchmark_results <span class="op">=</span> {</span>
<span id="cb1-466"><a href="#cb1-466" aria-hidden="true" tabindex="-1"></a>            <span class="st">'masses'</span>: mass_results,</span>
<span id="cb1-467"><a href="#cb1-467" aria-hidden="true" tabindex="-1"></a>            <span class="st">'lifetimes'</span>: lifetime_results,</span>
<span id="cb1-468"><a href="#cb1-468" aria-hidden="true" tabindex="-1"></a>            <span class="st">'cross_sections'</span>: cross_section_results</span>
<span id="cb1-469"><a href="#cb1-469" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb1-470"><a href="#cb1-470" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-471"><a href="#cb1-471" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Generate summary statistics</span></span>
<span id="cb1-472"><a href="#cb1-472" aria-hidden="true" tabindex="-1"></a>        summary <span class="op">=</span> <span class="va">self</span>.generate_benchmark_summary()</span>
<span id="cb1-473"><a href="#cb1-473" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-474"><a href="#cb1-474" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.benchmark_results, summary</span>
<span id="cb1-475"><a href="#cb1-475" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-476"><a href="#cb1-476" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> generate_benchmark_summary(<span class="va">self</span>):</span>
<span id="cb1-477"><a href="#cb1-477" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Generate comprehensive benchmark summary"""</span></span>
<span id="cb1-478"><a href="#cb1-478" aria-hidden="true" tabindex="-1"></a>        summary <span class="op">=</span> {</span>
<span id="cb1-479"><a href="#cb1-479" aria-hidden="true" tabindex="-1"></a>            <span class="st">'total_particles_tested'</span>: <span class="dv">0</span>,</span>
<span id="cb1-480"><a href="#cb1-480" aria-hidden="true" tabindex="-1"></a>            <span class="st">'mass_accuracy'</span>: {<span class="st">'mean'</span>: <span class="dv">0</span>, <span class="st">'std'</span>: <span class="dv">0</span>, <span class="st">'distribution'</span>: {}},</span>
<span id="cb1-481"><a href="#cb1-481" aria-hidden="true" tabindex="-1"></a>            <span class="st">'lifetime_accuracy'</span>: {<span class="st">'mean'</span>: <span class="dv">0</span>, <span class="st">'std'</span>: <span class="dv">0</span>, <span class="st">'distribution'</span>: {}},</span>
<span id="cb1-482"><a href="#cb1-482" aria-hidden="true" tabindex="-1"></a>            <span class="st">'cross_section_accuracy'</span>: {<span class="st">'mean'</span>: <span class="dv">0</span>, <span class="st">'std'</span>: <span class="dv">0</span>, <span class="st">'distribution'</span>: {}},</span>
<span id="cb1-483"><a href="#cb1-483" aria-hidden="true" tabindex="-1"></a>            <span class="st">'overall_score'</span>: <span class="dv">0</span></span>
<span id="cb1-484"><a href="#cb1-484" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb1-485"><a href="#cb1-485" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-486"><a href="#cb1-486" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Mass accuracy summary</span></span>
<span id="cb1-487"><a href="#cb1-487" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">'masses'</span> <span class="kw">in</span> <span class="va">self</span>.benchmark_results:</span>
<span id="cb1-488"><a href="#cb1-488" aria-hidden="true" tabindex="-1"></a>            mass_accuracies <span class="op">=</span> [r[<span class="st">'accuracy'</span>] <span class="cf">for</span> r <span class="kw">in</span> <span class="va">self</span>.benchmark_results[<span class="st">'masses'</span>].values()]</span>
<span id="cb1-489"><a href="#cb1-489" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> mass_accuracies:</span>
<span id="cb1-490"><a href="#cb1-490" aria-hidden="true" tabindex="-1"></a>                summary[<span class="st">'mass_accuracy'</span>][<span class="st">'mean'</span>] <span class="op">=</span> np.mean(mass_accuracies)</span>
<span id="cb1-491"><a href="#cb1-491" aria-hidden="true" tabindex="-1"></a>                summary[<span class="st">'mass_accuracy'</span>][<span class="st">'std'</span>] <span class="op">=</span> np.std(mass_accuracies)</span>
<span id="cb1-492"><a href="#cb1-492" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb1-493"><a href="#cb1-493" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Distribution by agreement level</span></span>
<span id="cb1-494"><a href="#cb1-494" aria-hidden="true" tabindex="-1"></a>                agreement_levels <span class="op">=</span> [r[<span class="st">'agreement_level'</span>] <span class="cf">for</span> r <span class="kw">in</span> <span class="va">self</span>.benchmark_results[<span class="st">'masses'</span>].values()]</span>
<span id="cb1-495"><a href="#cb1-495" aria-hidden="true" tabindex="-1"></a>                summary[<span class="st">'mass_accuracy'</span>][<span class="st">'distribution'</span>] <span class="op">=</span> {</span>
<span id="cb1-496"><a href="#cb1-496" aria-hidden="true" tabindex="-1"></a>                    level: agreement_levels.count(level) <span class="cf">for</span> level <span class="kw">in</span> <span class="bu">set</span>(agreement_levels)</span>
<span id="cb1-497"><a href="#cb1-497" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb1-498"><a href="#cb1-498" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-499"><a href="#cb1-499" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Lifetime accuracy summary</span></span>
<span id="cb1-500"><a href="#cb1-500" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">'lifetimes'</span> <span class="kw">in</span> <span class="va">self</span>.benchmark_results:</span>
<span id="cb1-501"><a href="#cb1-501" aria-hidden="true" tabindex="-1"></a>            lifetime_accuracies <span class="op">=</span> [r[<span class="st">'accuracy'</span>] <span class="cf">for</span> r <span class="kw">in</span> <span class="va">self</span>.benchmark_results[<span class="st">'lifetimes'</span>].values()]</span>
<span id="cb1-502"><a href="#cb1-502" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> lifetime_accuracies:</span>
<span id="cb1-503"><a href="#cb1-503" aria-hidden="true" tabindex="-1"></a>                summary[<span class="st">'lifetime_accuracy'</span>][<span class="st">'mean'</span>] <span class="op">=</span> np.mean(lifetime_accuracies)</span>
<span id="cb1-504"><a href="#cb1-504" aria-hidden="true" tabindex="-1"></a>                summary[<span class="st">'lifetime_accuracy'</span>][<span class="st">'std'</span>] <span class="op">=</span> np.std(lifetime_accuracies)</span>
<span id="cb1-505"><a href="#cb1-505" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb1-506"><a href="#cb1-506" aria-hidden="true" tabindex="-1"></a>                agreement_levels <span class="op">=</span> [r[<span class="st">'agreement_level'</span>] <span class="cf">for</span> r <span class="kw">in</span> <span class="va">self</span>.benchmark_results[<span class="st">'lifetimes'</span>].values()]</span>
<span id="cb1-507"><a href="#cb1-507" aria-hidden="true" tabindex="-1"></a>                summary[<span class="st">'lifetime_accuracy'</span>][<span class="st">'distribution'</span>] <span class="op">=</span> {</span>
<span id="cb1-508"><a href="#cb1-508" aria-hidden="true" tabindex="-1"></a>                    level: agreement_levels.count(level) <span class="cf">for</span> level <span class="kw">in</span> <span class="bu">set</span>(agreement_levels)</span>
<span id="cb1-509"><a href="#cb1-509" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb1-510"><a href="#cb1-510" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-511"><a href="#cb1-511" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Cross-section accuracy summary</span></span>
<span id="cb1-512"><a href="#cb1-512" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">'cross_sections'</span> <span class="kw">in</span> <span class="va">self</span>.benchmark_results:</span>
<span id="cb1-513"><a href="#cb1-513" aria-hidden="true" tabindex="-1"></a>            cs_accuracies <span class="op">=</span> [r[<span class="st">'avg_accuracy'</span>] <span class="cf">for</span> r <span class="kw">in</span> <span class="va">self</span>.benchmark_results[<span class="st">'cross_sections'</span>].values()]</span>
<span id="cb1-514"><a href="#cb1-514" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> cs_accuracies:</span>
<span id="cb1-515"><a href="#cb1-515" aria-hidden="true" tabindex="-1"></a>                summary[<span class="st">'cross_section_accuracy'</span>][<span class="st">'mean'</span>] <span class="op">=</span> np.mean(cs_accuracies)</span>
<span id="cb1-516"><a href="#cb1-516" aria-hidden="true" tabindex="-1"></a>                summary[<span class="st">'cross_section_accuracy'</span>][<span class="st">'std'</span>] <span class="op">=</span> np.std(cs_accuracies)</span>
<span id="cb1-517"><a href="#cb1-517" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb1-518"><a href="#cb1-518" aria-hidden="true" tabindex="-1"></a>                agreement_levels <span class="op">=</span> [r[<span class="st">'agreement_level'</span>] <span class="cf">for</span> r <span class="kw">in</span> <span class="va">self</span>.benchmark_results[<span class="st">'cross_sections'</span>].values()]</span>
<span id="cb1-519"><a href="#cb1-519" aria-hidden="true" tabindex="-1"></a>                summary[<span class="st">'cross_section_accuracy'</span>][<span class="st">'distribution'</span>] <span class="op">=</span> {</span>
<span id="cb1-520"><a href="#cb1-520" aria-hidden="true" tabindex="-1"></a>                    level: agreement_levels.count(level) <span class="cf">for</span> level <span class="kw">in</span> <span class="bu">set</span>(agreement_levels)</span>
<span id="cb1-521"><a href="#cb1-521" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb1-522"><a href="#cb1-522" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-523"><a href="#cb1-523" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Overall score (weighted average)</span></span>
<span id="cb1-524"><a href="#cb1-524" aria-hidden="true" tabindex="-1"></a>        mass_score <span class="op">=</span> summary[<span class="st">'mass_accuracy'</span>][<span class="st">'mean'</span>]</span>
<span id="cb1-525"><a href="#cb1-525" aria-hidden="true" tabindex="-1"></a>        lifetime_score <span class="op">=</span> summary[<span class="st">'lifetime_accuracy'</span>][<span class="st">'mean'</span>]</span>
<span id="cb1-526"><a href="#cb1-526" aria-hidden="true" tabindex="-1"></a>        cs_score <span class="op">=</span> summary[<span class="st">'cross_section_accuracy'</span>][<span class="st">'mean'</span>]</span>
<span id="cb1-527"><a href="#cb1-527" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-528"><a href="#cb1-528" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Weight by number of successful comparisons</span></span>
<span id="cb1-529"><a href="#cb1-529" aria-hidden="true" tabindex="-1"></a>        weights <span class="op">=</span> [</span>
<span id="cb1-530"><a href="#cb1-530" aria-hidden="true" tabindex="-1"></a>            <span class="bu">len</span>(<span class="va">self</span>.benchmark_results.get(<span class="st">'masses'</span>, {})),</span>
<span id="cb1-531"><a href="#cb1-531" aria-hidden="true" tabindex="-1"></a>            <span class="bu">len</span>(<span class="va">self</span>.benchmark_results.get(<span class="st">'lifetimes'</span>, {})),</span>
<span id="cb1-532"><a href="#cb1-532" aria-hidden="true" tabindex="-1"></a>            <span class="bu">len</span>(<span class="va">self</span>.benchmark_results.get(<span class="st">'cross_sections'</span>, {}))</span>
<span id="cb1-533"><a href="#cb1-533" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb1-534"><a href="#cb1-534" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-535"><a href="#cb1-535" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">sum</span>(weights) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb1-536"><a href="#cb1-536" aria-hidden="true" tabindex="-1"></a>            summary[<span class="st">'overall_score'</span>] <span class="op">=</span> (</span>
<span id="cb1-537"><a href="#cb1-537" aria-hidden="true" tabindex="-1"></a>                mass_score <span class="op">*</span> weights[<span class="dv">0</span>] <span class="op">+</span> </span>
<span id="cb1-538"><a href="#cb1-538" aria-hidden="true" tabindex="-1"></a>                lifetime_score <span class="op">*</span> weights[<span class="dv">1</span>] <span class="op">+</span> </span>
<span id="cb1-539"><a href="#cb1-539" aria-hidden="true" tabindex="-1"></a>                cs_score <span class="op">*</span> weights[<span class="dv">2</span>]</span>
<span id="cb1-540"><a href="#cb1-540" aria-hidden="true" tabindex="-1"></a>            ) <span class="op">/</span> <span class="bu">sum</span>(weights)</span>
<span id="cb1-541"><a href="#cb1-541" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-542"><a href="#cb1-542" aria-hidden="true" tabindex="-1"></a>        summary[<span class="st">'total_particles_tested'</span>] <span class="op">=</span> <span class="bu">len</span>(<span class="bu">set</span>(</span>
<span id="cb1-543"><a href="#cb1-543" aria-hidden="true" tabindex="-1"></a>            <span class="bu">list</span>(<span class="va">self</span>.benchmark_results.get(<span class="st">'masses'</span>, {}).keys()) <span class="op">+</span></span>
<span id="cb1-544"><a href="#cb1-544" aria-hidden="true" tabindex="-1"></a>            <span class="bu">list</span>(<span class="va">self</span>.benchmark_results.get(<span class="st">'lifetimes'</span>, {}).keys())</span>
<span id="cb1-545"><a href="#cb1-545" aria-hidden="true" tabindex="-1"></a>        ))</span>
<span id="cb1-546"><a href="#cb1-546" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-547"><a href="#cb1-547" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> summary</span>
<span id="cb1-548"><a href="#cb1-548" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-549"><a href="#cb1-549" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_benchmark_visualization(<span class="va">self</span>):</span>
<span id="cb1-550"><a href="#cb1-550" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Create comprehensive benchmarking visualization"""</span></span>
<span id="cb1-551"><a href="#cb1-551" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.benchmark_results:</span>
<span id="cb1-552"><a href="#cb1-552" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"No benchmark results available. Run benchmark first."</span>)</span>
<span id="cb1-553"><a href="#cb1-553" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb1-554"><a href="#cb1-554" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-555"><a href="#cb1-555" aria-hidden="true" tabindex="-1"></a>        fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">16</span>))</span>
<span id="cb1-556"><a href="#cb1-556" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-557"><a href="#cb1-557" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Mass comparison plot</span></span>
<span id="cb1-558"><a href="#cb1-558" aria-hidden="true" tabindex="-1"></a>        ax1 <span class="op">=</span> fig.add_subplot(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">1</span>)</span>
<span id="cb1-559"><a href="#cb1-559" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.plot_mass_comparison(ax1)</span>
<span id="cb1-560"><a href="#cb1-560" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-561"><a href="#cb1-561" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Lifetime comparison plot</span></span>
<span id="cb1-562"><a href="#cb1-562" aria-hidden="true" tabindex="-1"></a>        ax2 <span class="op">=</span> fig.add_subplot(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">2</span>)</span>
<span id="cb1-563"><a href="#cb1-563" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.plot_lifetime_comparison(ax2)</span>
<span id="cb1-564"><a href="#cb1-564" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-565"><a href="#cb1-565" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Cross-section comparison</span></span>
<span id="cb1-566"><a href="#cb1-566" aria-hidden="true" tabindex="-1"></a>        ax3 <span class="op">=</span> fig.add_subplot(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">3</span>)</span>
<span id="cb1-567"><a href="#cb1-567" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.plot_cross_section_comparison(ax3)</span>
<span id="cb1-568"><a href="#cb1-568" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-569"><a href="#cb1-569" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Accuracy distribution</span></span>
<span id="cb1-570"><a href="#cb1-570" aria-hidden="true" tabindex="-1"></a>        ax4 <span class="op">=</span> fig.add_subplot(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">4</span>)</span>
<span id="cb1-571"><a href="#cb1-571" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.plot_accuracy_distribution(ax4)</span>
<span id="cb1-572"><a href="#cb1-572" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-573"><a href="#cb1-573" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Particle-by-particle comparison</span></span>
<span id="cb1-574"><a href="#cb1-574" aria-hidden="true" tabindex="-1"></a>        ax5 <span class="op">=</span> fig.add_subplot(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb1-575"><a href="#cb1-575" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.plot_particle_accuracy_matrix(ax5)</span>
<span id="cb1-576"><a href="#cb1-576" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-577"><a href="#cb1-577" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Error analysis</span></span>
<span id="cb1-578"><a href="#cb1-578" aria-hidden="true" tabindex="-1"></a>        ax6 <span class="op">=</span> fig.add_subplot(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>)</span>
<span id="cb1-579"><a href="#cb1-579" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.plot_error_analysis(ax6)</span>
<span id="cb1-580"><a href="#cb1-580" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-581"><a href="#cb1-581" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Z-score distribution</span></span>
<span id="cb1-582"><a href="#cb1-582" aria-hidden="true" tabindex="-1"></a>        ax7 <span class="op">=</span> fig.add_subplot(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">7</span>)</span>
<span id="cb1-583"><a href="#cb1-583" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.plot_statistical_significance(ax7)</span>
<span id="cb1-584"><a href="#cb1-584" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-585"><a href="#cb1-585" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Summary scorecard</span></span>
<span id="cb1-586"><a href="#cb1-586" aria-hidden="true" tabindex="-1"></a>        ax8 <span class="op">=</span> fig.add_subplot(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>)</span>
<span id="cb1-587"><a href="#cb1-587" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.plot_summary_scorecard(ax8)</span>
<span id="cb1-588"><a href="#cb1-588" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-589"><a href="#cb1-589" aria-hidden="true" tabindex="-1"></a>        plt.tight_layout()</span>
<span id="cb1-590"><a href="#cb1-590" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> fig</span>
<span id="cb1-591"><a href="#cb1-591" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-592"><a href="#cb1-592" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> plot_mass_comparison(<span class="va">self</span>, ax):</span>
<span id="cb1-593"><a href="#cb1-593" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Plot CFS vs experimental masses"""</span></span>
<span id="cb1-594"><a href="#cb1-594" aria-hidden="true" tabindex="-1"></a>        mass_data <span class="op">=</span> <span class="va">self</span>.benchmark_results.get(<span class="st">'masses'</span>, {})</span>
<span id="cb1-595"><a href="#cb1-595" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> mass_data:</span>
<span id="cb1-596"><a href="#cb1-596" aria-hidden="true" tabindex="-1"></a>            ax.text(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="st">'No mass data'</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>)</span>
<span id="cb1-597"><a href="#cb1-597" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb1-598"><a href="#cb1-598" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-599"><a href="#cb1-599" aria-hidden="true" tabindex="-1"></a>        particles <span class="op">=</span> <span class="bu">list</span>(mass_data.keys())</span>
<span id="cb1-600"><a href="#cb1-600" aria-hidden="true" tabindex="-1"></a>        cfs_masses <span class="op">=</span> [mass_data[p][<span class="st">'cfs_mass'</span>] <span class="cf">for</span> p <span class="kw">in</span> particles]</span>
<span id="cb1-601"><a href="#cb1-601" aria-hidden="true" tabindex="-1"></a>        exp_masses <span class="op">=</span> [mass_data[p][<span class="st">'exp_mass'</span>] <span class="cf">for</span> p <span class="kw">in</span> particles]</span>
<span id="cb1-602"><a href="#cb1-602" aria-hidden="true" tabindex="-1"></a>        exp_errors <span class="op">=</span> [mass_data[p][<span class="st">'exp_error'</span>] <span class="cf">for</span> p <span class="kw">in</span> particles]</span>
<span id="cb1-603"><a href="#cb1-603" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-604"><a href="#cb1-604" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Log scale for masses spanning many orders</span></span>
<span id="cb1-605"><a href="#cb1-605" aria-hidden="true" tabindex="-1"></a>        ax.errorbar(exp_masses, cfs_masses, xerr<span class="op">=</span>exp_errors, </span>
<span id="cb1-606"><a href="#cb1-606" aria-hidden="true" tabindex="-1"></a>                   fmt<span class="op">=</span><span class="st">'o'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, capsize<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb1-607"><a href="#cb1-607" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-608"><a href="#cb1-608" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Perfect agreement line</span></span>
<span id="cb1-609"><a href="#cb1-609" aria-hidden="true" tabindex="-1"></a>        min_mass <span class="op">=</span> <span class="bu">min</span>(<span class="bu">min</span>(exp_masses), <span class="bu">min</span>(cfs_masses))</span>
<span id="cb1-610"><a href="#cb1-610" aria-hidden="true" tabindex="-1"></a>        max_mass <span class="op">=</span> <span class="bu">max</span>(<span class="bu">max</span>(exp_masses), <span class="bu">max</span>(cfs_masses))</span>
<span id="cb1-611"><a href="#cb1-611" aria-hidden="true" tabindex="-1"></a>        ax.plot([min_mass, max_mass], [min_mass, max_mass], <span class="st">'r--'</span>, </span>
<span id="cb1-612"><a href="#cb1-612" aria-hidden="true" tabindex="-1"></a>               label<span class="op">=</span><span class="st">'Perfect Agreement'</span>)</span>
<span id="cb1-613"><a href="#cb1-613" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-614"><a href="#cb1-614" aria-hidden="true" tabindex="-1"></a>        ax.set_xscale(<span class="st">'log'</span>)</span>
<span id="cb1-615"><a href="#cb1-615" aria-hidden="true" tabindex="-1"></a>        ax.set_yscale(<span class="st">'log'</span>)</span>
<span id="cb1-616"><a href="#cb1-616" aria-hidden="true" tabindex="-1"></a>        ax.set_xlabel(<span class="st">'Experimental Mass (MeV)'</span>)</span>
<span id="cb1-617"><a href="#cb1-617" aria-hidden="true" tabindex="-1"></a>        ax.set_ylabel(<span class="st">'CFS Predicted Mass (MeV)'</span>)</span>
<span id="cb1-618"><a href="#cb1-618" aria-hidden="true" tabindex="-1"></a>        ax.set_title(<span class="st">'Mass Predictions vs Experiment'</span>)</span>
<span id="cb1-619"><a href="#cb1-619" aria-hidden="true" tabindex="-1"></a>        ax.legend()</span>
<span id="cb1-620"><a href="#cb1-620" aria-hidden="true" tabindex="-1"></a>        ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb1-621"><a href="#cb1-621" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-622"><a href="#cb1-622" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Add particle labels</span></span>
<span id="cb1-623"><a href="#cb1-623" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, particle <span class="kw">in</span> <span class="bu">enumerate</span>(particles):</span>
<span id="cb1-624"><a href="#cb1-624" aria-hidden="true" tabindex="-1"></a>            ax.annotate(particle, (exp_masses[i], cfs_masses[i]), </span>
<span id="cb1-625"><a href="#cb1-625" aria-hidden="true" tabindex="-1"></a>                       fontsize<span class="op">=</span><span class="dv">8</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb1-626"><a href="#cb1-626" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-627"><a href="#cb1-627" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> plot_lifetime_comparison(<span class="va">self</span>, ax):</span>
<span id="cb1-628"><a href="#cb1-628" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Plot CFS vs experimental lifetimes"""</span></span>
<span id="cb1-629"><a href="#cb1-629" aria-hidden="true" tabindex="-1"></a>        lifetime_data <span class="op">=</span> <span class="va">self</span>.benchmark_results.get(<span class="st">'lifetimes'</span>, {})</span>
<span id="cb1-630"><a href="#cb1-630" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> lifetime_data:</span>
<span id="cb1-631"><a href="#cb1-631" aria-hidden="true" tabindex="-1"></a>            ax.text(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="st">'No lifetime data'</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>)</span>
<span id="cb1-632"><a href="#cb1-632" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb1-633"><a href="#cb1-633" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-634"><a href="#cb1-634" aria-hidden="true" tabindex="-1"></a>        particles <span class="op">=</span> <span class="bu">list</span>(lifetime_data.keys())</span>
<span id="cb1-635"><a href="#cb1-635" aria-hidden="true" tabindex="-1"></a>        cfs_lifetimes <span class="op">=</span> [lifetime_data[p][<span class="st">'cfs_lifetime'</span>] <span class="cf">for</span> p <span class="kw">in</span> particles]</span>
<span id="cb1-636"><a href="#cb1-636" aria-hidden="true" tabindex="-1"></a>        exp_lifetimes <span class="op">=</span> [lifetime_data[p][<span class="st">'exp_lifetime'</span>] <span class="cf">for</span> p <span class="kw">in</span> particles]</span>
<span id="cb1-637"><a href="#cb1-637" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-638"><a href="#cb1-638" aria-hidden="true" tabindex="-1"></a>        ax.scatter(exp_lifetimes, cfs_lifetimes, alpha<span class="op">=</span><span class="fl">0.7</span>, s<span class="op">=</span><span class="dv">60</span>)</span>
<span id="cb1-639"><a href="#cb1-639" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-640"><a href="#cb1-640" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Perfect agreement line</span></span>
<span id="cb1-641"><a href="#cb1-641" aria-hidden="true" tabindex="-1"></a>        min_lt <span class="op">=</span> <span class="bu">min</span>(<span class="bu">min</span>(exp_lifetimes), <span class="bu">min</span>(cfs_lifetimes))</span>
<span id="cb1-642"><a href="#cb1-642" aria-hidden="true" tabindex="-1"></a>        max_lt <span class="op">=</span> <span class="bu">max</span>(<span class="bu">max</span>(exp_lifetimes), <span class="bu">max</span>(cfs_lifetimes))</span>
<span id="cb1-643"><a href="#cb1-643" aria-hidden="true" tabindex="-1"></a>        ax.plot([min_lt, max_lt], [min_lt, max_lt], <span class="st">'r--'</span>, </span>
<span id="cb1-644"><a href="#cb1-644" aria-hidden="true" tabindex="-1"></a>               label<span class="op">=</span><span class="st">'Perfect Agreement'</span>)</span>
<span id="cb1-645"><a href="#cb1-645" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-646"><a href="#cb1-646" aria-hidden="true" tabindex="-1"></a>        ax.set_xscale(<span class="st">'log'</span>)</span>
<span id="cb1-647"><a href="#cb1-647" aria-hidden="true" tabindex="-1"></a>        ax.set_yscale(<span class="st">'log'</span>)</span>
<span id="cb1-648"><a href="#cb1-648" aria-hidden="true" tabindex="-1"></a>        ax.set_xlabel(<span class="st">'Experimental Lifetime (s)'</span>)</span>
<span id="cb1-649"><a href="#cb1-649" aria-hidden="true" tabindex="-1"></a>        ax.set_ylabel(<span class="st">'CFS Predicted Lifetime (s)'</span>)</span>
<span id="cb1-650"><a href="#cb1-650" aria-hidden="true" tabindex="-1"></a>        ax.set_title(<span class="st">'Lifetime Predictions vs Experiment'</span>)</span>
<span id="cb1-651"><a href="#cb1-651" aria-hidden="true" tabindex="-1"></a>        ax.legend()</span>
<span id="cb1-652"><a href="#cb1-652" aria-hidden="true" tabindex="-1"></a>        ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb1-653"><a href="#cb1-653" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-654"><a href="#cb1-654" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, particle <span class="kw">in</span> <span class="bu">enumerate</span>(particles):</span>
<span id="cb1-655"><a href="#cb1-655" aria-hidden="true" tabindex="-1"></a>            ax.annotate(particle, (exp_lifetimes[i], cfs_lifetimes[i]), </span>
<span id="cb1-656"><a href="#cb1-656" aria-hidden="true" tabindex="-1"></a>                       fontsize<span class="op">=</span><span class="dv">8</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb1-657"><a href="#cb1-657" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-658"><a href="#cb1-658" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> plot_cross_section_comparison(<span class="va">self</span>, ax):</span>
<span id="cb1-659"><a href="#cb1-659" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Plot cross-section predictions"""</span></span>
<span id="cb1-660"><a href="#cb1-660" aria-hidden="true" tabindex="-1"></a>        cs_data <span class="op">=</span> <span class="va">self</span>.benchmark_results.get(<span class="st">'cross_sections'</span>, {})</span>
<span id="cb1-661"><a href="#cb1-661" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> cs_data:</span>
<span id="cb1-662"><a href="#cb1-662" aria-hidden="true" tabindex="-1"></a>            ax.text(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="st">'No cross-section data'</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>)</span>
<span id="cb1-663"><a href="#cb1-663" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb1-664"><a href="#cb1-664" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-665"><a href="#cb1-665" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, (process, data) <span class="kw">in</span> <span class="bu">enumerate</span>(cs_data.items()):</span>
<span id="cb1-666"><a href="#cb1-666" aria-hidden="true" tabindex="-1"></a>            energies <span class="op">=</span> data[<span class="st">'energies'</span>]</span>
<span id="cb1-667"><a href="#cb1-667" aria-hidden="true" tabindex="-1"></a>            cfs_cs <span class="op">=</span> data[<span class="st">'cfs_cross_sections'</span>]</span>
<span id="cb1-668"><a href="#cb1-668" aria-hidden="true" tabindex="-1"></a>            exp_cs <span class="op">=</span> data[<span class="st">'exp_cross_sections'</span>]</span>
<span id="cb1-669"><a href="#cb1-669" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-670"><a href="#cb1-670" aria-hidden="true" tabindex="-1"></a>            ax.plot(energies, exp_cs, <span class="st">'o-'</span>, label<span class="op">=</span><span class="ss">f'</span><span class="sc">{</span>process<span class="sc">}</span><span class="ss"> (exp)'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb1-671"><a href="#cb1-671" aria-hidden="true" tabindex="-1"></a>            ax.plot(energies, cfs_cs, <span class="st">'s--'</span>, label<span class="op">=</span><span class="ss">f'</span><span class="sc">{</span>process<span class="sc">}</span><span class="ss"> (CFS)'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb1-672"><a href="#cb1-672" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-673"><a href="#cb1-673" aria-hidden="true" tabindex="-1"></a>        ax.set_xscale(<span class="st">'log'</span>)</span>
<span id="cb1-674"><a href="#cb1-674" aria-hidden="true" tabindex="-1"></a>        ax.set_yscale(<span class="st">'log'</span>)</span>
<span id="cb1-675"><a href="#cb1-675" aria-hidden="true" tabindex="-1"></a>        ax.set_xlabel(<span class="st">'Energy (GeV)'</span>)</span>
<span id="cb1-676"><a href="#cb1-676" aria-hidden="true" tabindex="-1"></a>        ax.set_ylabel(<span class="st">'Cross Section (mb)'</span>)</span>
<span id="cb1-677"><a href="#cb1-677" aria-hidden="true" tabindex="-1"></a>        ax.set_title(<span class="st">'Cross Section Predictions'</span>)</span>
<span id="cb1-678"><a href="#cb1-678" aria-hidden="true" tabindex="-1"></a>        ax.legend()</span>
<span id="cb1-679"><a href="#cb1-679" aria-hidden="true" tabindex="-1"></a>        ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb1-680"><a href="#cb1-680" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-681"><a href="#cb1-681" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> plot_accuracy_distribution(<span class="va">self</span>, ax):</span>
<span id="cb1-682"><a href="#cb1-682" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Plot distribution of accuracy scores"""</span></span>
<span id="cb1-683"><a href="#cb1-683" aria-hidden="true" tabindex="-1"></a>        all_accuracies <span class="op">=</span> []</span>
<span id="cb1-684"><a href="#cb1-684" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-685"><a href="#cb1-685" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Collect all accuracy scores</span></span>
<span id="cb1-686"><a href="#cb1-686" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> category, data <span class="kw">in</span> <span class="va">self</span>.benchmark_results.items():</span>
<span id="cb1-687"><a href="#cb1-687" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> category <span class="op">==</span> <span class="st">'masses'</span>:</span>
<span id="cb1-688"><a href="#cb1-688" aria-hidden="true" tabindex="-1"></a>                all_accuracies.extend([r[<span class="st">'accuracy'</span>] <span class="cf">for</span> r <span class="kw">in</span> data.values()])</span>
<span id="cb1-689"><a href="#cb1-689" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> category <span class="op">==</span> <span class="st">'lifetimes'</span>:</span>
<span id="cb1-690"><a href="#cb1-690" aria-hidden="true" tabindex="-1"></a>                all_accuracies.extend([r[<span class="st">'accuracy'</span>] <span class="cf">for</span> r <span class="kw">in</span> data.values()])</span>
<span id="cb1-691"><a href="#cb1-691" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> category <span class="op">==</span> <span class="st">'cross_sections'</span>:</span>
<span id="cb1-692"><a href="#cb1-692" aria-hidden="true" tabindex="-1"></a>                all_accuracies.extend([r[<span class="st">'avg_accuracy'</span>] <span class="cf">for</span> r <span class="kw">in</span> data.values()])</span>
<span id="cb1-693"><a href="#cb1-693" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-694"><a href="#cb1-694" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> all_accuracies:</span>
<span id="cb1-695"><a href="#cb1-695" aria-hidden="true" tabindex="-1"></a>            ax.hist(all_accuracies, bins<span class="op">=</span><span class="dv">20</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb1-696"><a href="#cb1-696" aria-hidden="true" tabindex="-1"></a>            ax.axvline(np.mean(all_accuracies), color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, </span>
<span id="cb1-697"><a href="#cb1-697" aria-hidden="true" tabindex="-1"></a>                      label<span class="op">=</span><span class="ss">f'Mean: </span><span class="sc">{</span>np<span class="sc">.</span>mean(all_accuracies)<span class="sc">:.3f}</span><span class="ss">'</span>)</span>
<span id="cb1-698"><a href="#cb1-698" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-699"><a href="#cb1-699" aria-hidden="true" tabindex="-1"></a>        ax.set_xlabel(<span class="st">'Accuracy Score'</span>)</span>
<span id="cb1-700"><a href="#cb1-700" aria-hidden="true" tabindex="-1"></a>        ax.set_ylabel(<span class="st">'Count'</span>)</span>
<span id="cb1-701"><a href="#cb1-701" aria-hidden="true" tabindex="-1"></a>        ax.set_title(<span class="st">'Distribution of Accuracy Scores'</span>)</span>
<span id="cb1-702"><a href="#cb1-702" aria-hidden="true" tabindex="-1"></a>        ax.legend()</span>
<span id="cb1-703"><a href="#cb1-703" aria-hidden="true" tabindex="-1"></a>        ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb1-704"><a href="#cb1-704" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-705"><a href="#cb1-705" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> plot_particle_accuracy_matrix(<span class="va">self</span>, ax):</span>
<span id="cb1-706"><a href="#cb1-706" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Plot particle-by-particle accuracy matrix"""</span></span>
<span id="cb1-707"><a href="#cb1-707" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Collect particles and their accuracies across different metrics</span></span>
<span id="cb1-708"><a href="#cb1-708" aria-hidden="true" tabindex="-1"></a>        particles <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb1-709"><a href="#cb1-709" aria-hidden="true" tabindex="-1"></a>        particles.update(<span class="va">self</span>.benchmark_results.get(<span class="st">'masses'</span>, {}).keys())</span>
<span id="cb1-710"><a href="#cb1-710" aria-hidden="true" tabindex="-1"></a>        particles.update(<span class="va">self</span>.benchmark_results.get(<span class="st">'lifetimes'</span>, {}).keys())</span>
<span id="cb1-711"><a href="#cb1-711" aria-hidden="true" tabindex="-1"></a>        particles <span class="op">=</span> <span class="bu">sorted</span>(particles)</span>
<span id="cb1-712"><a href="#cb1-712" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-713"><a href="#cb1-713" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> particles:</span>
<span id="cb1-714"><a href="#cb1-714" aria-hidden="true" tabindex="-1"></a>            ax.text(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="st">'No particle data'</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>)</span>
<span id="cb1-715"><a href="#cb1-715" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb1-716"><a href="#cb1-716" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-717"><a href="#cb1-717" aria-hidden="true" tabindex="-1"></a>        metrics <span class="op">=</span> [<span class="st">'Mass'</span>, <span class="st">'Lifetime'</span>]</span>
<span id="cb1-718"><a href="#cb1-718" aria-hidden="true" tabindex="-1"></a>        accuracy_matrix <span class="op">=</span> np.zeros((<span class="bu">len</span>(particles), <span class="bu">len</span>(metrics)))</span>
<span id="cb1-719"><a href="#cb1-719" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-720"><a href="#cb1-720" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, particle <span class="kw">in</span> <span class="bu">enumerate</span>(particles):</span>
<span id="cb1-721"><a href="#cb1-721" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Mass accuracy</span></span>
<span id="cb1-722"><a href="#cb1-722" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> particle <span class="kw">in</span> <span class="va">self</span>.benchmark_results.get(<span class="st">'masses'</span>, {}):</span>
<span id="cb1-723"><a href="#cb1-723" aria-hidden="true" tabindex="-1"></a>                accuracy_matrix[i, <span class="dv">0</span>] <span class="op">=</span> <span class="va">self</span>.benchmark_results[<span class="st">'masses'</span>][particle][<span class="st">'accuracy'</span>]</span>
<span id="cb1-724"><a href="#cb1-724" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-725"><a href="#cb1-725" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Lifetime accuracy</span></span>
<span id="cb1-726"><a href="#cb1-726" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> particle <span class="kw">in</span> <span class="va">self</span>.benchmark_results.get(<span class="st">'lifetimes'</span>, {}):</span>
<span id="cb1-727"><a href="#cb1-727" aria-hidden="true" tabindex="-1"></a>                accuracy_matrix[i, <span class="dv">1</span>] <span class="op">=</span> <span class="va">self</span>.benchmark_results[<span class="st">'lifetimes'</span>][particle][<span class="st">'accuracy'</span>]</span>
<span id="cb1-728"><a href="#cb1-728" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-729"><a href="#cb1-729" aria-hidden="true" tabindex="-1"></a>        im <span class="op">=</span> ax.imshow(accuracy_matrix, cmap<span class="op">=</span><span class="st">'RdYlGn'</span>, aspect<span class="op">=</span><span class="st">'auto'</span>, vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb1-730"><a href="#cb1-730" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-731"><a href="#cb1-731" aria-hidden="true" tabindex="-1"></a>        ax.set_xticks(<span class="bu">range</span>(<span class="bu">len</span>(metrics)))</span>
<span id="cb1-732"><a href="#cb1-732" aria-hidden="true" tabindex="-1"></a>        ax.set_xticklabels(metrics)</span>
<span id="cb1-733"><a href="#cb1-733" aria-hidden="true" tabindex="-1"></a>        ax.set_yticks(<span class="bu">range</span>(<span class="bu">len</span>(particles)))</span>
<span id="cb1-734"><a href="#cb1-734" aria-hidden="true" tabindex="-1"></a>        ax.set_yticklabels(particles, fontsize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb1-735"><a href="#cb1-735" aria-hidden="true" tabindex="-1"></a>        ax.set_title(<span class="st">'Particle Accuracy Matrix'</span>)</span>
<span id="cb1-736"><a href="#cb1-736" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-737"><a href="#cb1-737" aria-hidden="true" tabindex="-1"></a>        plt.colorbar(im, ax<span class="op">=</span>ax, label<span class="op">=</span><span class="st">'Accuracy Score'</span>)</span>
<span id="cb1-738"><a href="#cb1-738" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-739"><a href="#cb1-739" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> plot_error_analysis(<span class="va">self</span>, ax):</span>
<span id="cb1-740"><a href="#cb1-740" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Plot error analysis by particle type"""</span></span>
<span id="cb1-741"><a href="#cb1-741" aria-hidden="true" tabindex="-1"></a>        mass_data <span class="op">=</span> <span class="va">self</span>.benchmark_results.get(<span class="st">'masses'</span>, {})</span>
<span id="cb1-742"><a href="#cb1-742" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-743"><a href="#cb1-743" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> mass_data:</span>
<span id="cb1-744"><a href="#cb1-744" aria-hidden="true" tabindex="-1"></a>            ax.text(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="st">'No mass data'</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>)</span>
<span id="cb1-745"><a href="#cb1-745" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb1-746"><a href="#cb1-746" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-747"><a href="#cb1-747" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Group by particle type</span></span>
<span id="cb1-748"><a href="#cb1-748" aria-hidden="true" tabindex="-1"></a>        particle_types <span class="op">=</span> {}</span>
<span id="cb1-749"><a href="#cb1-749" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> particle, data <span class="kw">in</span> mass_data.items():</span>
<span id="cb1-750"><a href="#cb1-750" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> particle <span class="kw">in</span> <span class="va">self</span>.cfs_sim.particles:</span>
<span id="cb1-751"><a href="#cb1-751" aria-hidden="true" tabindex="-1"></a>                ptype <span class="op">=</span> <span class="va">self</span>.cfs_sim.particles[particle][<span class="st">'type'</span>]</span>
<span id="cb1-752"><a href="#cb1-752" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> ptype <span class="kw">not</span> <span class="kw">in</span> particle_types:</span>
<span id="cb1-753"><a href="#cb1-753" aria-hidden="true" tabindex="-1"></a>                    particle_types[ptype] <span class="op">=</span> []</span>
<span id="cb1-754"><a href="#cb1-754" aria-hidden="true" tabindex="-1"></a>                particle_types[ptype].append(data[<span class="st">'relative_error'</span>])</span>
<span id="cb1-755"><a href="#cb1-755" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-756"><a href="#cb1-756" aria-hidden="true" tabindex="-1"></a>        types <span class="op">=</span> <span class="bu">list</span>(particle_types.keys())</span>
<span id="cb1-757"><a href="#cb1-757" aria-hidden="true" tabindex="-1"></a>        errors <span class="op">=</span> [particle_types[t] <span class="cf">for</span> t <span class="kw">in</span> types]</span>
<span id="cb1-758"><a href="#cb1-758" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-759"><a href="#cb1-759" aria-hidden="true" tabindex="-1"></a>        ax.boxplot(errors, labels<span class="op">=</span>types)</span>
<span id="cb1-760"><a href="#cb1-760" aria-hidden="true" tabindex="-1"></a>        ax.set_ylabel(<span class="st">'Relative Error'</span>)</span>
<span id="cb1-761"><a href="#cb1-761" aria-hidden="true" tabindex="-1"></a>        ax.set_title(<span class="st">'Error Distribution by Particle Type'</span>)</span>
<span id="cb1-762"><a href="#cb1-762" aria-hidden="true" tabindex="-1"></a>        ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb1-763"><a href="#cb1-763" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-764"><a href="#cb1-764" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> plot_statistical_significance(<span class="va">self</span>, ax):</span>
<span id="cb1-765"><a href="#cb1-765" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Plot Z-score distribution for statistical significance"""</span></span>
<span id="cb1-766"><a href="#cb1-766" aria-hidden="true" tabindex="-1"></a>        mass_data <span class="op">=</span> <span class="va">self</span>.benchmark_results.get(<span class="st">'masses'</span>, {})</span>
<span id="cb1-767"><a href="#cb1-767" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-768"><a href="#cb1-768" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> mass_data:</span>
<span id="cb1-769"><a href="#cb1-769" aria-hidden="true" tabindex="-1"></a>            ax.text(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="st">'No Z-score data'</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>)</span>
<span id="cb1-770"><a href="#cb1-770" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb1-771"><a href="#cb1-771" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-772"><a href="#cb1-772" aria-hidden="true" tabindex="-1"></a>        z_scores <span class="op">=</span> [data[<span class="st">'z_score'</span>] <span class="cf">for</span> data <span class="kw">in</span> mass_data.values() </span>
<span id="cb1-773"><a href="#cb1-773" aria-hidden="true" tabindex="-1"></a>                   <span class="cf">if</span> np.isfinite(data[<span class="st">'z_score'</span>])]</span>
<span id="cb1-774"><a href="#cb1-774" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-775"><a href="#cb1-775" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> z_scores:</span>
<span id="cb1-776"><a href="#cb1-776" aria-hidden="true" tabindex="-1"></a>            ax.hist(z_scores, bins<span class="op">=</span><span class="dv">15</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb1-777"><a href="#cb1-777" aria-hidden="true" tabindex="-1"></a>            ax.axvline(<span class="fl">1.96</span>, color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'95</span><span class="sc">% c</span><span class="st">onfidence'</span>)</span>
<span id="cb1-778"><a href="#cb1-778" aria-hidden="true" tabindex="-1"></a>            ax.axvline(<span class="fl">2.58</span>, color<span class="op">=</span><span class="st">'orange'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'99</span><span class="sc">% c</span><span class="st">onfidence'</span>)</span>
<span id="cb1-779"><a href="#cb1-779" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-780"><a href="#cb1-780" aria-hidden="true" tabindex="-1"></a>        ax.set_xlabel(<span class="st">'Z-score'</span>)</span>
<span id="cb1-781"><a href="#cb1-781" aria-hidden="true" tabindex="-1"></a>        ax.set_ylabel(<span class="st">'Count'</span>)</span>
<span id="cb1-782"><a href="#cb1-782" aria-hidden="true" tabindex="-1"></a>        ax.set_title(<span class="st">'Statistical Significance (Z-scores)'</span>)</span>
<span id="cb1-783"><a href="#cb1-783" aria-hidden="true" tabindex="-1"></a>        ax.legend()</span>
<span id="cb1-784"><a href="#cb1-784" aria-hidden="true" tabindex="-1"></a>        ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb1-785"><a href="#cb1-785" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-786"><a href="#cb1-786" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> plot_summary_scorecard(<span class="va">self</span>, ax):</span>
<span id="cb1-787"><a href="#cb1-787" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Plot summary scorecard"""</span></span>
<span id="cb1-788"><a href="#cb1-788" aria-hidden="true" tabindex="-1"></a>        ax.axis(<span class="st">'off'</span>)</span>
<span id="cb1-789"><a href="#cb1-789" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-790"><a href="#cb1-790" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Generate summary</span></span>
<span id="cb1-791"><a href="#cb1-791" aria-hidden="true" tabindex="-1"></a>        summary <span class="op">=</span> <span class="va">self</span>.generate_benchmark_summary()</span>
<span id="cb1-792"><a href="#cb1-792" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-793"><a href="#cb1-793" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create scorecard text</span></span>
<span id="cb1-794"><a href="#cb1-794" aria-hidden="true" tabindex="-1"></a>        scorecard_text <span class="op">=</span> <span class="ss">f"""</span></span>
<span id="cb1-795"><a href="#cb1-795" aria-hidden="true" tabindex="-1"></a><span class="ss">CFS STANDARD MODEL BENCHMARK</span></span>
<span id="cb1-796"><a href="#cb1-796" aria-hidden="true" tabindex="-1"></a><span class="sc">{</span><span class="st">'='</span><span class="op">*</span><span class="dv">35</span><span class="sc">}</span></span>
<span id="cb1-797"><a href="#cb1-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-798"><a href="#cb1-798" aria-hidden="true" tabindex="-1"></a><span class="ss">OVERALL SCORE: </span><span class="sc">{</span>summary[<span class="st">'overall_score'</span>]<span class="sc">:.3f}</span></span>
<span id="cb1-799"><a href="#cb1-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-800"><a href="#cb1-800" aria-hidden="true" tabindex="-1"></a><span class="ss">MASS PREDICTIONS:</span></span>
<span id="cb1-801"><a href="#cb1-801" aria-hidden="true" tabindex="-1"></a><span class="ss">  Mean Accuracy: </span><span class="sc">{</span>summary[<span class="st">'mass_accuracy'</span>][<span class="st">'mean'</span>]<span class="sc">:.3f}</span></span>
<span id="cb1-802"><a href="#cb1-802" aria-hidden="true" tabindex="-1"></a><span class="ss">  Std Deviation: </span><span class="sc">{</span>summary[<span class="st">'mass_accuracy'</span>][<span class="st">'std'</span>]<span class="sc">:.3f}</span></span>
<span id="cb1-803"><a href="#cb1-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-804"><a href="#cb1-804" aria-hidden="true" tabindex="-1"></a><span class="ss">LIFETIME PREDICTIONS:</span></span>
<span id="cb1-805"><a href="#cb1-805" aria-hidden="true" tabindex="-1"></a><span class="ss">  Mean Accuracy: </span><span class="sc">{</span>summary[<span class="st">'lifetime_accuracy'</span>][<span class="st">'mean'</span>]<span class="sc">:.3f}</span></span>
<span id="cb1-806"><a href="#cb1-806" aria-hidden="true" tabindex="-1"></a><span class="ss">  Std Deviation: </span><span class="sc">{</span>summary[<span class="st">'lifetime_accuracy'</span>][<span class="st">'std'</span>]<span class="sc">:.3f}</span></span>
<span id="cb1-807"><a href="#cb1-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-808"><a href="#cb1-808" aria-hidden="true" tabindex="-1"></a><span class="ss">CROSS-SECTIONS:</span></span>
<span id="cb1-809"><a href="#cb1-809" aria-hidden="true" tabindex="-1"></a><span class="ss">  Mean Accuracy: </span><span class="sc">{</span>summary[<span class="st">'cross_section_accuracy'</span>][<span class="st">'mean'</span>]<span class="sc">:.3f}</span></span>
<span id="cb1-810"><a href="#cb1-810" aria-hidden="true" tabindex="-1"></a><span class="ss">  Std Deviation: </span><span class="sc">{</span>summary[<span class="st">'cross_section_accuracy'</span>][<span class="st">'std'</span>]<span class="sc">:.3f}</span></span>
<span id="cb1-811"><a href="#cb1-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-812"><a href="#cb1-812" aria-hidden="true" tabindex="-1"></a><span class="ss">PARTICLES TESTED: </span><span class="sc">{</span>summary[<span class="st">'total_particles_tested'</span>]<span class="sc">}</span></span>
<span id="cb1-813"><a href="#cb1-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-814"><a href="#cb1-814" aria-hidden="true" tabindex="-1"></a><span class="ss">AGREEMENT LEVELS:</span></span>
<span id="cb1-815"><a href="#cb1-815" aria-hidden="true" tabindex="-1"></a><span class="ss">"""</span></span>
<span id="cb1-816"><a href="#cb1-816" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-817"><a href="#cb1-817" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Add agreement distribution</span></span>
<span id="cb1-818"><a href="#cb1-818" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> category <span class="kw">in</span> [<span class="st">'masses'</span>, <span class="st">'lifetimes'</span>, <span class="st">'cross_sections'</span>]:</span>
<span id="cb1-819"><a href="#cb1-819" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> category <span class="kw">in</span> summary <span class="kw">and</span> <span class="st">'distribution'</span> <span class="kw">in</span> summary[<span class="ss">f'</span><span class="sc">{</span>category<span class="sc">.</span>rstrip(<span class="st">"s"</span>)<span class="sc">}</span><span class="ss">_accuracy'</span>]:</span>
<span id="cb1-820"><a href="#cb1-820" aria-hidden="true" tabindex="-1"></a>                dist <span class="op">=</span> summary[<span class="ss">f'</span><span class="sc">{</span>category<span class="sc">.</span>rstrip(<span class="st">"s"</span>)<span class="sc">}</span><span class="ss">_accuracy'</span>][<span class="st">'distribution'</span>]</span>
<span id="cb1-821"><a href="#cb1-821" aria-hidden="true" tabindex="-1"></a>                scorecard_text <span class="op">+=</span> <span class="ss">f"</span><span class="ch">\n</span><span class="sc">{</span>category<span class="sc">.</span>upper()<span class="sc">}</span><span class="ss">:</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb1-822"><a href="#cb1-822" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> level, count <span class="kw">in</span> dist.items():</span>
<span id="cb1-823"><a href="#cb1-823" aria-hidden="true" tabindex="-1"></a>                    scorecard_text <span class="op">+=</span> <span class="ss">f"  </span><span class="sc">{</span>level<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>count<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span></span>
<span id="cb1-824"><a href="#cb1-824" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-825"><a href="#cb1-825" aria-hidden="true" tabindex="-1"></a>        ax.text(<span class="fl">0.05</span>, <span class="fl">0.95</span>, scorecard_text, transform<span class="op">=</span>ax.transAxes,</span>
<span id="cb1-826"><a href="#cb1-826" aria-hidden="true" tabindex="-1"></a>               fontsize<span class="op">=</span><span class="dv">10</span>, verticalalignment<span class="op">=</span><span class="st">'top'</span>, fontfamily<span class="op">=</span><span class="st">'monospace'</span>,</span>
<span id="cb1-827"><a href="#cb1-827" aria-hidden="true" tabindex="-1"></a>               bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">"round,pad=0.5"</span>, facecolor<span class="op">=</span><span class="st">"lightgray"</span>, alpha<span class="op">=</span><span class="fl">0.8</span>))</span>
<span id="cb1-828"><a href="#cb1-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-829"><a href="#cb1-829" aria-hidden="true" tabindex="-1"></a><span class="co"># Integration with existing CFS simulator</span></span>
<span id="cb1-830"><a href="#cb1-830" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> run_comprehensive_benchmarking():</span>
<span id="cb1-831"><a href="#cb1-831" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Run complete benchmarking analysis"""</span></span>
<span id="cb1-832"><a href="#cb1-832" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"=== Initializing CFS Standard Model for Benchmarking ==="</span>)</span>
<span id="cb1-833"><a href="#cb1-833" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-834"><a href="#cb1-834" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create a simplified CFS simulator for benchmarking</span></span>
<span id="cb1-835"><a href="#cb1-835" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> SimplifiedCFSSimulator:</span>
<span id="cb1-836"><a href="#cb1-836" aria-hidden="true" tabindex="-1"></a>        <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb1-837"><a href="#cb1-837" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.phi <span class="op">=</span> (<span class="dv">1</span> <span class="op">+</span> np.sqrt(<span class="dv">5</span>)) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb1-838"><a href="#cb1-838" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.alpha_em <span class="op">=</span> <span class="dv">1</span><span class="op">/</span><span class="dv">137</span></span>
<span id="cb1-839"><a href="#cb1-839" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.alpha_s <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb1-840"><a href="#cb1-840" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.alpha_w <span class="op">=</span> <span class="fl">0.03</span></span>
<span id="cb1-841"><a href="#cb1-841" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.D_base <span class="op">=</span> <span class="fl">1e-12</span></span>
<span id="cb1-842"><a href="#cb1-842" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.T_base <span class="op">=</span> <span class="fl">1e-23</span></span>
<span id="cb1-843"><a href="#cb1-843" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-844"><a href="#cb1-844" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.particles <span class="op">=</span> {</span>
<span id="cb1-845"><a href="#cb1-845" aria-hidden="true" tabindex="-1"></a>                <span class="st">'up'</span>: {<span class="st">'type'</span>: <span class="st">'quark'</span>, <span class="st">'charge'</span>: <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>, <span class="st">'mass'</span>: <span class="fl">2.3</span>, <span class="st">'n_level'</span>: <span class="dv">4</span>},</span>
<span id="cb1-846"><a href="#cb1-846" aria-hidden="true" tabindex="-1"></a>                <span class="st">'down'</span>: {<span class="st">'type'</span>: <span class="st">'quark'</span>, <span class="st">'charge'</span>: <span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">3</span>, <span class="st">'mass'</span>: <span class="fl">4.8</span>, <span class="st">'n_level'</span>: <span class="dv">4</span>},</span>
<span id="cb1-847"><a href="#cb1-847" aria-hidden="true" tabindex="-1"></a>                <span class="st">'charm'</span>: {<span class="st">'type'</span>: <span class="st">'quark'</span>, <span class="st">'charge'</span>: <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>, <span class="st">'mass'</span>: <span class="dv">1275</span>, <span class="st">'n_level'</span>: <span class="dv">5</span>},</span>
<span id="cb1-848"><a href="#cb1-848" aria-hidden="true" tabindex="-1"></a>                <span class="st">'strange'</span>: {<span class="st">'type'</span>: <span class="st">'quark'</span>, <span class="st">'charge'</span>: <span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">3</span>, <span class="st">'mass'</span>: <span class="dv">95</span>, <span class="st">'n_level'</span>: <span class="dv">5</span>},</span>
<span id="cb1-849"><a href="#cb1-849" aria-hidden="true" tabindex="-1"></a>                <span class="st">'top'</span>: {<span class="st">'type'</span>: <span class="st">'quark'</span>, <span class="st">'charge'</span>: <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>, <span class="st">'mass'</span>: <span class="dv">173000</span>, <span class="st">'n_level'</span>: <span class="dv">6</span>},</span>
<span id="cb1-850"><a href="#cb1-850" aria-hidden="true" tabindex="-1"></a>                <span class="st">'bottom'</span>: {<span class="st">'type'</span>: <span class="st">'quark'</span>, <span class="st">'charge'</span>: <span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">3</span>, <span class="st">'mass'</span>: <span class="dv">4180</span>, <span class="st">'n_level'</span>: <span class="dv">6</span>},</span>
<span id="cb1-851"><a href="#cb1-851" aria-hidden="true" tabindex="-1"></a>                <span class="st">'electron'</span>: {<span class="st">'type'</span>: <span class="st">'lepton'</span>, <span class="st">'charge'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'mass'</span>: <span class="fl">0.511</span>, <span class="st">'n_level'</span>: <span class="dv">2</span>},</span>
<span id="cb1-852"><a href="#cb1-852" aria-hidden="true" tabindex="-1"></a>                <span class="st">'muon'</span>: {<span class="st">'type'</span>: <span class="st">'lepton'</span>, <span class="st">'charge'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'mass'</span>: <span class="fl">105.7</span>, <span class="st">'n_level'</span>: <span class="dv">3</span>},</span>
<span id="cb1-853"><a href="#cb1-853" aria-hidden="true" tabindex="-1"></a>                <span class="st">'tau'</span>: {<span class="st">'type'</span>: <span class="st">'lepton'</span>, <span class="st">'charge'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'mass'</span>: <span class="dv">1777</span>, <span class="st">'n_level'</span>: <span class="dv">4</span>},</span>
<span id="cb1-854"><a href="#cb1-854" aria-hidden="true" tabindex="-1"></a>                <span class="st">'electron_neutrino'</span>: {<span class="st">'type'</span>: <span class="st">'neutrino'</span>, <span class="st">'charge'</span>: <span class="dv">0</span>, <span class="st">'mass'</span>: <span class="fl">0.001</span>, <span class="st">'n_level'</span>: <span class="dv">1</span>},</span>
<span id="cb1-855"><a href="#cb1-855" aria-hidden="true" tabindex="-1"></a>                <span class="st">'muon_neutrino'</span>: {<span class="st">'type'</span>: <span class="st">'neutrino'</span>, <span class="st">'charge'</span>: <span class="dv">0</span>, <span class="st">'mass'</span>: <span class="fl">0.001</span>, <span class="st">'n_level'</span>: <span class="dv">2</span>},</span>
<span id="cb1-856"><a href="#cb1-856" aria-hidden="true" tabindex="-1"></a>                <span class="st">'tau_neutrino'</span>: {<span class="st">'type'</span>: <span class="st">'neutrino'</span>, <span class="st">'charge'</span>: <span class="dv">0</span>, <span class="st">'mass'</span>: <span class="fl">0.001</span>, <span class="st">'n_level'</span>: <span class="dv">3</span>},</span>
<span id="cb1-857"><a href="#cb1-857" aria-hidden="true" tabindex="-1"></a>                <span class="st">'photon'</span>: {<span class="st">'type'</span>: <span class="st">'gauge'</span>, <span class="st">'charge'</span>: <span class="dv">0</span>, <span class="st">'mass'</span>: <span class="dv">0</span>, <span class="st">'n_level'</span>: <span class="dv">1</span>},</span>
<span id="cb1-858"><a href="#cb1-858" aria-hidden="true" tabindex="-1"></a>                <span class="st">'W_boson'</span>: {<span class="st">'type'</span>: <span class="st">'gauge'</span>, <span class="st">'charge'</span>: <span class="dv">1</span>, <span class="st">'mass'</span>: <span class="dv">80379</span>, <span class="st">'n_level'</span>: <span class="dv">4</span>},</span>
<span id="cb1-859"><a href="#cb1-859" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Z_boson'</span>: {<span class="st">'type'</span>: <span class="st">'gauge'</span>, <span class="st">'charge'</span>: <span class="dv">0</span>, <span class="st">'mass'</span>: <span class="dv">91188</span>, <span class="st">'n_level'</span>: <span class="dv">4</span>},</span>
<span id="cb1-860"><a href="#cb1-860" aria-hidden="true" tabindex="-1"></a>                <span class="st">'gluon'</span>: {<span class="st">'type'</span>: <span class="st">'gauge'</span>, <span class="st">'charge'</span>: <span class="dv">0</span>, <span class="st">'mass'</span>: <span class="dv">0</span>, <span class="st">'n_level'</span>: <span class="dv">3</span>},</span>
<span id="cb1-861"><a href="#cb1-861" aria-hidden="true" tabindex="-1"></a>                <span class="st">'higgs'</span>: {<span class="st">'type'</span>: <span class="st">'scalar'</span>, <span class="st">'charge'</span>: <span class="dv">0</span>, <span class="st">'mass'</span>: <span class="dv">125100</span>, <span class="st">'n_level'</span>: <span class="dv">5</span>}</span>
<span id="cb1-862"><a href="#cb1-862" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb1-863"><a href="#cb1-863" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-864"><a href="#cb1-864" aria-hidden="true" tabindex="-1"></a>        <span class="kw">def</span> cfs_particle_coherence(<span class="va">self</span>, particle_name, t<span class="op">=</span><span class="dv">0</span>):</span>
<span id="cb1-865"><a href="#cb1-865" aria-hidden="true" tabindex="-1"></a>            particle <span class="op">=</span> <span class="va">self</span>.particles[particle_name]</span>
<span id="cb1-866"><a href="#cb1-866" aria-hidden="true" tabindex="-1"></a>            n <span class="op">=</span> particle[<span class="st">'n_level'</span>]</span>
<span id="cb1-867"><a href="#cb1-867" aria-hidden="true" tabindex="-1"></a>            D_eff <span class="op">=</span> <span class="va">self</span>.D_base <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> particle[<span class="st">'mass'</span>] <span class="op">/</span> <span class="dv">1000</span>)</span>
<span id="cb1-868"><a href="#cb1-868" aria-hidden="true" tabindex="-1"></a>            T_eff <span class="op">=</span> <span class="va">self</span>.T_base <span class="op">*</span> (n <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> <span class="va">self</span>.phi<span class="op">**</span>(n<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb1-869"><a href="#cb1-869" aria-hidden="true" tabindex="-1"></a>            coherence <span class="op">=</span> <span class="va">self</span>.phi<span class="op">**</span>n <span class="op">*</span> np.sqrt(D_eff <span class="op">*</span> T_eff) <span class="op">*</span> np.exp(<span class="op">-</span><span class="fl">0.001</span> <span class="op">*</span> t)</span>
<span id="cb1-870"><a href="#cb1-870" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> coherence</span>
<span id="cb1-871"><a href="#cb1-871" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-872"><a href="#cb1-872" aria-hidden="true" tabindex="-1"></a>        <span class="kw">def</span> signature_matching(<span class="va">self</span>, particle1, particle2):</span>
<span id="cb1-873"><a href="#cb1-873" aria-hidden="true" tabindex="-1"></a>            p1 <span class="op">=</span> <span class="va">self</span>.particles[particle1]</span>
<span id="cb1-874"><a href="#cb1-874" aria-hidden="true" tabindex="-1"></a>            p2 <span class="op">=</span> <span class="va">self</span>.particles[particle2]</span>
<span id="cb1-875"><a href="#cb1-875" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-876"><a href="#cb1-876" aria-hidden="true" tabindex="-1"></a>            charge_match <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> <span class="bu">abs</span>(p1[<span class="st">'charge'</span>] <span class="op">-</span> p2[<span class="st">'charge'</span>]))</span>
<span id="cb1-877"><a href="#cb1-877" aria-hidden="true" tabindex="-1"></a>            mass_ratio <span class="op">=</span> <span class="bu">max</span>(p1[<span class="st">'mass'</span>], p2[<span class="st">'mass'</span>]) <span class="op">/</span> (<span class="bu">min</span>(p1[<span class="st">'mass'</span>], p2[<span class="st">'mass'</span>]) <span class="op">+</span> <span class="fl">1e-6</span>)</span>
<span id="cb1-878"><a href="#cb1-878" aria-hidden="true" tabindex="-1"></a>            mass_match <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> <span class="bu">abs</span>(mass_ratio <span class="op">-</span> <span class="va">self</span>.phi))</span>
<span id="cb1-879"><a href="#cb1-879" aria-hidden="true" tabindex="-1"></a>            n_diff <span class="op">=</span> <span class="bu">abs</span>(p1[<span class="st">'n_level'</span>] <span class="op">-</span> p2[<span class="st">'n_level'</span>])</span>
<span id="cb1-880"><a href="#cb1-880" aria-hidden="true" tabindex="-1"></a>            level_match <span class="op">=</span> np.exp(<span class="op">-</span>n_diff <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb1-881"><a href="#cb1-881" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-882"><a href="#cb1-882" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> charge_match <span class="op">*</span> mass_match <span class="op">*</span> level_match</span>
<span id="cb1-883"><a href="#cb1-883" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-884"><a href="#cb1-884" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create simulator and benchmarking engine</span></span>
<span id="cb1-885"><a href="#cb1-885" aria-hidden="true" tabindex="-1"></a>    cfs_sim <span class="op">=</span> SimplifiedCFSSimulator()</span>
<span id="cb1-886"><a href="#cb1-886" aria-hidden="true" tabindex="-1"></a>    benchmark_engine <span class="op">=</span> CFSBenchmarkingEngine(cfs_sim)</span>
<span id="cb1-887"><a href="#cb1-887" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-888"><a href="#cb1-888" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Run comprehensive benchmark</span></span>
<span id="cb1-889"><a href="#cb1-889" aria-hidden="true" tabindex="-1"></a>    results, summary <span class="op">=</span> benchmark_engine.run_comprehensive_benchmark()</span>
<span id="cb1-890"><a href="#cb1-890" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-891"><a href="#cb1-891" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create visualization</span></span>
<span id="cb1-892"><a href="#cb1-892" aria-hidden="true" tabindex="-1"></a>    fig <span class="op">=</span> benchmark_engine.create_benchmark_visualization()</span>
<span id="cb1-893"><a href="#cb1-893" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-894"><a href="#cb1-894" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Print detailed results</span></span>
<span id="cb1-895"><a href="#cb1-895" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">=== BENCHMARKING RESULTS ==="</span>)</span>
<span id="cb1-896"><a href="#cb1-896" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Overall Score: </span><span class="sc">{</span>summary[<span class="st">'overall_score'</span>]<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb1-897"><a href="#cb1-897" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Particles Tested: </span><span class="sc">{</span>summary[<span class="st">'total_particles_tested'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-898"><a href="#cb1-898" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-899"><a href="#cb1-899" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">=== MASS PREDICTIONS ==="</span>)</span>
<span id="cb1-900"><a href="#cb1-900" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Mean Accuracy: </span><span class="sc">{</span>summary[<span class="st">'mass_accuracy'</span>][<span class="st">'mean'</span>]<span class="sc">:.3f}</span><span class="ss"> ± </span><span class="sc">{</span>summary[<span class="st">'mass_accuracy'</span>][<span class="st">'std'</span>]<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb1-901"><a href="#cb1-901" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-902"><a href="#cb1-902" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">=== LIFETIME PREDICTIONS ==="</span>)</span>
<span id="cb1-903"><a href="#cb1-903" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Mean Accuracy: </span><span class="sc">{</span>summary[<span class="st">'lifetime_accuracy'</span>][<span class="st">'mean'</span>]<span class="sc">:.3f}</span><span class="ss"> ± </span><span class="sc">{</span>summary[<span class="st">'lifetime_accuracy'</span>][<span class="st">'std'</span>]<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb1-904"><a href="#cb1-904" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-905"><a href="#cb1-905" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">=== CROSS-SECTION PREDICTIONS ==="</span>)</span>
<span id="cb1-906"><a href="#cb1-906" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Mean Accuracy: </span><span class="sc">{</span>summary[<span class="st">'cross_section_accuracy'</span>][<span class="st">'mean'</span>]<span class="sc">:.3f}</span><span class="ss"> ± </span><span class="sc">{</span>summary[<span class="st">'cross_section_accuracy'</span>][<span class="st">'std'</span>]<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb1-907"><a href="#cb1-907" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-908"><a href="#cb1-908" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">=== DETAILED PARTICLE ANALYSIS ==="</span>)</span>
<span id="cb1-909"><a href="#cb1-909" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> particle, data <span class="kw">in</span> results[<span class="st">'masses'</span>].items():</span>
<span id="cb1-910"><a href="#cb1-910" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>particle<span class="sc">}</span><span class="ss">:"</span>)</span>
<span id="cb1-911"><a href="#cb1-911" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"  CFS Mass: </span><span class="sc">{</span>data[<span class="st">'cfs_mass'</span>]<span class="sc">:.2f}</span><span class="ss"> MeV"</span>)</span>
<span id="cb1-912"><a href="#cb1-912" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"  Exp Mass: </span><span class="sc">{</span>data[<span class="st">'exp_mass'</span>]<span class="sc">:.2f}</span><span class="ss"> ± </span><span class="sc">{</span>data[<span class="st">'exp_error'</span>]<span class="sc">:.2f}</span><span class="ss"> MeV"</span>)</span>
<span id="cb1-913"><a href="#cb1-913" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"  Accuracy: </span><span class="sc">{</span>data[<span class="st">'accuracy'</span>]<span class="sc">:.3f}</span><span class="ss"> (</span><span class="sc">{</span>data[<span class="st">'agreement_level'</span>]<span class="sc">}</span><span class="ss">)"</span>)</span>
<span id="cb1-914"><a href="#cb1-914" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"  Z-score: </span><span class="sc">{</span>data[<span class="st">'z_score'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb1-915"><a href="#cb1-915" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-916"><a href="#cb1-916" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fig, benchmark_engine, results, summary</span>
<span id="cb1-917"><a href="#cb1-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-918"><a href="#cb1-918" aria-hidden="true" tabindex="-1"></a><span class="co"># Execute benchmarking</span></span>
<span id="cb1-919"><a href="#cb1-919" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">"__main__"</span>:</span>
<span id="cb1-920"><a href="#cb1-920" aria-hidden="true" tabindex="-1"></a>    fig, engine, results, summary <span class="op">=</span> run_comprehensive_benchmarking()</span>
<span id="cb1-921"><a href="#cb1-921" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>=== Initializing CFS Standard Model for Benchmarking ===
=== CFS Standard Model Benchmarking ===
Comparing simulation with experimental data...

=== BENCHMARKING RESULTS ===
Overall Score: 0.028
Particles Tested: 12

=== MASS PREDICTIONS ===
Mean Accuracy: 0.000 ± 0.000

=== LIFETIME PREDICTIONS ===
Mean Accuracy: 0.017 ± 0.001

=== CROSS-SECTION PREDICTIONS ===
Mean Accuracy: 0.224 ± 0.224

=== DETAILED PARTICLE ANALYSIS ===
up:
  CFS Mass: 0.00 MeV
  Exp Mass: 2.16 ± 0.49 MeV
  Accuracy: 0.000 (very_poor)
  Z-score: 4.41
down:
  CFS Mass: 0.00 MeV
  Exp Mass: 4.67 ± 0.48 MeV
  Accuracy: 0.000 (very_poor)
  Z-score: 9.73
charm:
  CFS Mass: 0.00 MeV
  Exp Mass: 1270.00 ± 20.00 MeV
  Accuracy: 0.000 (very_poor)
  Z-score: 63.50
strange:
  CFS Mass: 0.00 MeV
  Exp Mass: 93.40 ± 5.00 MeV
  Accuracy: 0.000 (very_poor)
  Z-score: 18.68
top:
  CFS Mass: 0.00 MeV
  Exp Mass: 172760.00 ± 300.00 MeV
  Accuracy: 0.000 (very_poor)
  Z-score: 575.87
bottom:
  CFS Mass: 0.00 MeV
  Exp Mass: 4180.00 ± 30.00 MeV
  Accuracy: 0.000 (very_poor)
  Z-score: 139.33
electron:
  CFS Mass: 0.00 MeV
  Exp Mass: 0.51 ± 0.00 MeV
  Accuracy: 0.000 (very_poor)
  Z-score: 164838369.71
muon:
  CFS Mass: 0.00 MeV
  Exp Mass: 105.66 ± 0.00 MeV
  Accuracy: 0.000 (very_poor)
  Z-score: 44024322.71
tau:
  CFS Mass: 0.00 MeV
  Exp Mass: 1776.86 ± 0.12 MeV
  Accuracy: 0.000 (very_poor)
  Z-score: 14807.17
W_boson:
  CFS Mass: 0.00 MeV
  Exp Mass: 80379.00 ± 12.00 MeV
  Accuracy: 0.000 (very_poor)
  Z-score: 6698.25
Z_boson:
  CFS Mass: 0.00 MeV
  Exp Mass: 91187.60 ± 2.10 MeV
  Accuracy: 0.000 (very_poor)
  Z-score: 43422.67
higgs:
  CFS Mass: 0.00 MeV
  Exp Mass: 125100.00 ± 240.00 MeV
  Accuracy: 0.000 (very_poor)
  Z-score: 521.25</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="11-compare-scales_files/figure-html/cell-2-output-2.png" class="figure-img" width="1909" height="1526"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="references" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="references"><span class="header-section-number">1.7</span> References</h2>
<ol type="1">
<li>Finster, F. “Causal Fermion Systems: A Primer for Lorentzian Geometers.” arXiv:2201.06382.</li>
<li>Finster, F., Kleiner, J. “Causal Fermion Systems: Spacetime as the Web of Correlations.” arXiv:2504.19272.</li>
<li>Wolfram, S. “Finally We May Have a Path to the Fundamental Theory of Physics.” writings.stephenwolfram.com, 2020.</li>
<li>Sornette, D. “Discrete scale invariance and complex dimensions.” Physics Reports, 1998.</li>
<li>Algorithmic Botany Group. “Visual Models of Morphogenesis.” algorithmicbotany.org, 2006.</li>
<li>World Scientific. “Fractals, Golden Mean and the Physics of the Universe.” 2023.</li>
</ol>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p><a href="mailto:mvtta@proton.me">email</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>mariana emauz valdetaro ⟷ mvtta | 2025</p>
</div>
  </div>
</footer>




</body></html>